{"version":3,"sources":["../src/graphics/gameplay/gameplay.ts"],"sourcesContent":["import { EventBusManager } from \"@utils/event_management/eventBusFactory\";\r\nimport { getGlobalContext } from \"@utils/globalContext\";\r\nimport { GlobalState } from \"@utils/state/globalState\";\r\nimport { Camera, Scene, WebGLRenderer } from \"three\";\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport { createPlayer, Player, PlayerProps } from \"./player\";\r\n\r\nexport interface GameplayOptions {\r\n  player: PlayerProps;\r\n}\r\n\r\nexport interface GameplayContext {\r\n  globalState: GlobalState;\r\n  eventBusManager: EventBusManager;\r\n}\r\n\r\nexport interface ThreeJSContext {\r\n  scene: Scene;\r\n  renderer: WebGLRenderer;\r\n  camera: Camera;\r\n  controls: OrbitControls;\r\n}\r\n\r\nexport interface Gameplay {\r\n  mount: (context: ThreeJSContext) => void;\r\n  update: () => void;\r\n  unmount: () => void;\r\n}\r\n\r\ninterface References {\r\n  player: Player;\r\n}\r\n\r\nexport const createGameplay = (options: GameplayOptions): Gameplay => {\r\n  const { globalState, eventBusManager, globalStorage } = getGlobalContext();\r\n\r\n  let references: References;\r\n\r\n  const mount = (context: ThreeJSContext) => {\r\n    const player = createPlayer(\r\n      {\r\n        ids: options.player.ids,\r\n      },\r\n      {\r\n        scene: context.scene,\r\n      }\r\n    );\r\n    player.create();\r\n\r\n    references = {\r\n      player: player,\r\n    };\r\n  };\r\n\r\n  const update = () => {\r\n    references.player.update(0);\r\n  };\r\n\r\n  const unmount = () => {\r\n    references.player.destroy();\r\n  };\r\n\r\n  return {\r\n    mount: mount,\r\n    update: update,\r\n    unmount: unmount,\r\n  };\r\n};\r\n"],"mappings":";;;;;;;;AAiCO,IAAM,iBAAiB,CAAC,YAAuC;AACpE,QAAM,EAAE,aAAa,iBAAiB,cAAc,IAAI,iBAAiB;AAEzE,MAAI;AAEJ,QAAM,QAAQ,CAAC,YAA4B;AACzC,UAAM,SAAS;AAAA,MACb;AAAA,QACE,KAAK,QAAQ,OAAO;AAAA,MACtB;AAAA,MACA;AAAA,QACE,OAAO,QAAQ;AAAA,MACjB;AAAA,IACF;AACA,WAAO,OAAO;AAEd,iBAAa;AAAA,MACX;AAAA,IACF;AAAA,EACF;AAEA,QAAM,SAAS,MAAM;AACnB,eAAW,OAAO,OAAO,CAAC;AAAA,EAC5B;AAEA,QAAM,UAAU,MAAM;AACpB,eAAW,OAAO,QAAQ;AAAA,EAC5B;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;","names":[]}