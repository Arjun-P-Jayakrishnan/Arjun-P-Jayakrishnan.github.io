{"version":3,"sources":["../src/engine/core/Engine.ts"],"names":["createEngine","serviceRegistry","getServiceRegistry","logger","lifecycleScheduler","storage","input","domManager","renderManager","scene2DManager","onInit","createDomManager","createRenderManager","createScene2DManager","onLoad","queueStep","onMount","onUpdate","onUnmount","toggleButton","portfolio2D","portfolio3D"],"mappings":"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","file":"chunk-UPEYEV7N.js","sourcesContent":["import { createScene2DManager, Scene2DManager } from \"2d/scene2DManager\";\nimport { queueStep } from \"@utils/dsl\";\nimport { createDomManager, DOMManager } from \"engine/managers/DOMManger\";\nimport {\n  createRenderManager,\n  RenderManager,\n} from \"engine/managers/RenderManager\";\nimport { ServiceRegistry } from \"types/service.types\";\nimport { getServiceRegistry } from \"./ServiceRegistry\";\n\ninterface Engine {\n  run: () => void;\n}\n/**\n * @description Orchestration Layer that acts as a link to native\n * browser events for performing updates\n * @returns {Engine}\n */\nconst createEngine = (): Engine => {\n  const serviceRegistry: ServiceRegistry = getServiceRegistry();\n  const [logger, lifecycleScheduler, storage, input] = [\n    serviceRegistry.get(\"Logger\"),\n    serviceRegistry.get(\"LifecycleScheduler\"),\n    serviceRegistry.get(\"GlobalStorageManager\"),\n    serviceRegistry.get(\"InputManager\"),\n  ];\n\n  let domManager: DOMManager;\n  let renderManager: RenderManager;\n  let scene2DManager: Scene2DManager;\n\n  const onInit = () => {\n    console.log(\"[Engine]: Engine initialized\");\n    domManager = createDomManager();\n    renderManager = createRenderManager();\n    scene2DManager = createScene2DManager();\n\n    //2D\n    lifecycleScheduler.schedule(scene2DManager.onInit);\n\n    //3D\n    lifecycleScheduler.schedule(storage.inflate);\n    lifecycleScheduler.schedule(input.onInit);\n    lifecycleScheduler.schedule(domManager.onInit);\n    lifecycleScheduler.schedule(renderManager.onInit);\n  };\n\n  const onLoad = () => {\n    //2D\n    lifecycleScheduler.schedule(scene2DManager.onLoad);\n\n    //3D\n    lifecycleScheduler.schedule(domManager.onLoad);\n    lifecycleScheduler.schedule(renderManager.onLoad);\n    lifecycleScheduler.schedule(queueStep(logger.onLoad, { origin: \"Engine\" }));\n  };\n\n  const onMount = () => {\n    logger.onMount({ origin: \"Engine\" });\n\n    //2D\n    lifecycleScheduler.schedule(scene2DManager.onMount);\n\n    //3D\n    lifecycleScheduler.schedule(domManager.onMount);\n    lifecycleScheduler.schedule(renderManager.onMount);\n  };\n\n  const onUpdate = () => {\n    //2D\n    scene2DManager.onUpdate();\n\n    //3D\n    domManager.onUpdate();\n    lifecycleScheduler.schedule(renderManager.onUpdate);\n  };\n\n  const onUnmount = () => {\n    //2D\n    scene2DManager.onUnmount();\n\n    //3D\n    logger.onUnmount({ origin: \"Engine\" });\n    lifecycleScheduler.schedule(domManager.onUnmount);\n    lifecycleScheduler.schedule(renderManager.onUnmount);\n    lifecycleScheduler.schedule(input.onUnmount);\n  };\n\n  const onDispose = () => {\n    //2D\n    scene2DManager.onDestroy();\n\n    //3D\n    logger.onDestroy({ origin: \"Engine\" });\n    lifecycleScheduler.schedule(domManager.onDestroy);\n    lifecycleScheduler.schedule(renderManager.onDestroy);\n  };\n\n  const run = () => {\n    //onLoad essentials before mounting\n    onInit();\n\n    //after dom loaded mount\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      onLoad();\n    });\n\n    //after resources are achieved\n    window.addEventListener(\"load\", () => {});\n\n    const toggleButton = document.getElementById(\n      \"toggle3D\"\n    ) as HTMLButtonElement;\n\n    const portfolio2D = document.getElementById(\"portfolio-2d\");\n    const portfolio3D = document.getElementById(\"portfolio-3d\");\n\n    if (toggleButton && portfolio2D && portfolio3D) {\n      toggleButton.addEventListener(\n        \"click\",\n        () => {\n          portfolio2D.style.display = \"none\";\n          portfolio3D.style.display = \"block\";\n\n          onMount();\n          onUpdate();\n        },\n        { once: true }\n      );\n    }\n\n    //unmount and dispose\n    window.addEventListener(\"beforeunload\", () => {\n      onUnmount();\n    });\n\n    //Deprecated\n    // window.addEventListener(\"unload\", () => {\n    //   onDispose();\n    // });\n\n    lifecycleScheduler.run();\n  };\n\n  return {\n    run: run,\n  };\n};\n\nexport { createEngine };\nexport type { Engine };\n"]}