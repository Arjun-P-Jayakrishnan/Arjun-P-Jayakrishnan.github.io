{"version":3,"sources":["../src/engine/managers/animation/AnimationManager.ts"],"names":["createAnimationOrchestrator","entities","addEntity","entity","removeEntity","id","deltaTime"],"mappings":"AA0DO,IAAMA,EAA8B,IAA6B,CAEtE,IAAMC,CAAAA,CAA4C,GAG5CC,CAAAA,CAAaC,CAAAA,EAA4B,CAC7CF,CAAAA,CAASE,CAAAA,CAAO,EAAE,CAAA,CAAIA,EACxB,EAGMC,CAAAA,CAAgBC,CAAAA,EAAe,CACnC,OAAOJ,CAAAA,CAASI,CAAE,EACpB,CAAA,CA2BA,OAAO,CACL,SAAA,CAAAH,EACA,YAAA,CAAAE,CAAAA,CACA,MA3BY,IAAM,CAEpB,EA0BE,OAAA,CAvBc,IAAM,CAEpB,MAAA,CAAO,IAAA,CAAKH,CAAQ,CAAA,CAAE,OAAA,CAAQG,CAAY,EAC5C,CAAA,CAqBE,MAAA,CAlBcE,CAAAA,EAAsB,CACpC,MAAA,CAAO,MAAA,CAAOL,CAAQ,CAAA,CAAE,OAAA,CAASE,GAAW,CAC1C,OAAA,CAAQ,IAAI,uCAAA,CAAyCA,CAAM,EAC3DA,CAAAA,CAAO,GAAA,CAAI,KAAKA,CAAAA,CAAO,MAAM,EAC7BA,CAAAA,CAAO,QAAA,CAAS,KAAKG,CAAAA,CAAWH,CAAAA,CAAO,MAAOA,CAAAA,CAAO,MAAA,CAAQA,EAAO,GAAG,EACzE,CAAC,EACH,CAAA,CAaE,qBAV4BE,CAAAA,EACrBJ,CAAAA,CAASI,CAAE,CAAA,EAAG,QAAA,CAAS,sBAAqB,EAAK,EAU1D,CACF","file":"chunk-QXLXZT3E.js","sourcesContent":["import { AnimationFSM } from \"./FSM\";\nimport { AnimationGraphRuntime } from \"./GraphRuntime\";\nimport { AnimationParameters } from \"./Parameters\";\nimport { PlaybackManager, PlayingAnimation } from \"./PlaybackManager\";\n\n/** Represents a single entity managed by the orchestrator */\nexport interface AnimationEntity {\n  /** Unique entity ID */\n  id: string;\n\n  /** Animation parameters for this entity */\n  params: AnimationParameters;\n\n  /** Animation graph runtime */\n  graph: AnimationGraphRuntime;\n\n  /** FSM controlling this entity */\n  fsm: AnimationFSM;\n\n  /** Playback manager handling clip playback */\n  playback: PlaybackManager;\n}\n\n/**\n * Public API exposed by the animation orchestrator.\n */\nexport interface AnimationOrchestrator {\n  /** Add or replace an entity */\n  addEntity(entity: AnimationEntity): void;\n\n  /** Remove an entity by ID */\n  removeEntity(id: string): void;\n\n  /** Mount lifecycle hook */\n  mount(): void;\n\n  /** Unmount lifecycle hook */\n  unmount(): void;\n\n  /** Update all entities */\n  update(deltaTime: number): void;\n\n  /** Query currently playing animations for an entity */\n  getPlayingAnimations(id: string): PlayingAnimation[];\n}\n\n/**\n * Creates an animation orchestrator.\n * Owns entity storage and drives FSM + playback lifecycles.\n *\n * @example\n * const orchestrator = createAnimationOrchestrator();\n *\n * orchestrator.addEntity(entity);\n * orchestrator.mount();\n *\n * orchestrator.update(0.016);\n */\nexport const createAnimationOrchestrator = (): AnimationOrchestrator => {\n  /** Internal storage of entities */\n  const entities: Record<string, AnimationEntity> = {};\n\n  /** Add or replace an entity */\n  const addEntity = (entity: AnimationEntity) => {\n    entities[entity.id] = entity;\n  };\n\n  /** Remove an entity by ID */\n  const removeEntity = (id: string) => {\n    delete entities[id];\n  };\n\n  /** Mount lifecycle hook */\n  const mount = () => {\n    // Reserved for future setup logic (events, graph init, etc.)\n  };\n\n  /** Unmount lifecycle hook */\n  const unmount = () => {\n    // Reserved for future teardown logic\n    Object.keys(entities).forEach(removeEntity);\n  };\n\n  /** Update all mounted entities */\n  const update = (deltaTime: number) => {\n    Object.values(entities).forEach((entity) => {\n      console.log(\"[update:AnimationOrchestrator] entity\", entity);\n      entity.fsm.tick(entity.params);\n      entity.playback.tick(deltaTime, entity.graph, entity.params, entity.fsm);\n    });\n  };\n\n  /** Get currently playing animations for a specific entity */\n  const getPlayingAnimations = (id: string): PlayingAnimation[] => {\n    return entities[id]?.playback.getPlayingAnimations() ?? [];\n  };\n\n  return {\n    addEntity,\n    removeEntity,\n    mount,\n    unmount,\n    update,\n    getPlayingAnimations,\n  };\n};\n"]}