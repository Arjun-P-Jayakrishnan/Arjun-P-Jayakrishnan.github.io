{"version":3,"sources":["../src/components/threejs/scene_inspector.ts"],"names":["template","SceneInspector","clone","eventBusManager","data","resizer","panel","e","newWidth","scene","objects","materialsMap","traverse","object","node","child","mat","treeNode","label","treeRoot","nodes","li","header","isCollapsed","nodeList","nodeRoot","ul"],"mappings":"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","file":"chunk-62RHAODD.js","sourcesContent":["import { EventBus } from \"@events/eventBus\";\nimport { EventBusManager } from \"@events/EventBusManager\";\nimport { Material, Object3D, Scene } from \"three\";\nimport { DebugEvents } from \"types/event.types\";\n\nconst template = document.createElement(\"template\");\ntemplate.innerHTML = `\n    <link rel=\"stylesheet\" href=\"/style/scene_inspector.css\">\n    <div class=\"inspector-wrapper\">\n\n      <div class=\"resizer\"></div>\n    \n      <div class=\"scene-inspector hidden\">\n        <div class=\"inspector-header\">\n          <span class=\"title\">Scene Inspector</span>\n          <button class=\"close-btn\"> ✕ </button>\n        </div>\n\n        <div class=\"inspector-content\">\n          <ul class=\"tree-view\">\n\n          </ul>\n        </div>\n      </div>\n\n      \n    </div>\n`;\n\n//\n\ninterface State {\n  isMenuHidden: boolean;\n  isResizing: boolean;\n}\n\ninterface TreeNode {\n  id: string;\n  label: string;\n  //  type: \"mesh\" | \"camera\" | \"light\" | \"animation\" | \"sprite\" | \"group\";\n  type: string;\n  nodes: TreeNode[];\n}\n\ninterface TreeView {\n  Objects: TreeNode[];\n  Materials: TreeNode[];\n}\n\nexport class SceneInspector extends HTMLElement {\n  root: ShadowRoot;\n  eventBus: EventBus<DebugEvents> | undefined;\n  state: State;\n  element: Element;\n  treeView: TreeView;\n\n  constructor() {\n    super();\n    this.root = this.attachShadow({ mode: \"open\" });\n    const clone = template.content.cloneNode(true);\n\n    this.root.appendChild(clone);\n    this.state = {\n      isMenuHidden: true,\n      isResizing: false,\n    };\n\n    this.element = this.root.querySelector(\".scene-inspector\")!;\n\n    this.treeView = {\n      Objects: [],\n      Materials: [],\n    };\n\n    this.handleResize();\n  }\n\n  set eventBusManager(eventBusManager: EventBusManager) {\n    this.eventBus = eventBusManager.debugBus;\n    this.eventBus?.on(\"debug:inspector\", (data) => {\n      this.handleShowHideEvent(data);\n    });\n  }\n\n  handleShowHideEvent(data: DebugEvents) {\n    this.state.isMenuHidden = !this.state.isMenuHidden;\n\n    if (this.state.isMenuHidden) {\n      this.element.classList.add(\"hidden\");\n    } else {\n      this.element.classList.remove(\"hidden\");\n      if (data.scene != null && data.scene !== undefined) {\n        this.renderTree(data.scene);\n      }\n    }\n  }\n\n  handleResize() {\n    const resizer: HTMLElement = this.root.querySelector(\".resizer\")!;\n    const panel: HTMLElement = this.root.querySelector(\".scene-inspector\")!;\n\n    resizer.addEventListener(\"mousedown\", (e) => {\n      this.state.isResizing = true;\n      document.body.style.cursor = \"ew-resize\";\n      e.preventDefault();\n    });\n\n    window.addEventListener(\"mousemove\", (e) => {\n      if (!this.state.isResizing) return;\n\n      const newWidth = window.innerWidth - (e as MouseEvent).clientX;\n\n      panel.style.width = `${Math.min(Math.max(newWidth, 200), 600)}px`;\n    });\n\n    window.addEventListener(\"mouseup\", (e) => {\n      if (this.state.isResizing) {\n        this.state.isResizing = false;\n        document.body.style.cursor = \"\";\n      }\n    });\n  }\n\n  toggleCloseButton() {\n    this.state.isMenuHidden = true;\n\n    this.element.classList.add(\"hidden\");\n  }\n\n  private collectSceneData(scene: Scene): TreeView {\n    const objects: TreeNode[] = [];\n    const materialsMap: Map<string, TreeNode> = new Map();\n\n    const traverse = (object: Object3D): TreeNode => {\n      const node: TreeNode = {\n        id: object.uuid,\n        label: object.name == \"\" ? object.type : object.name,\n        type: object.type,\n        nodes: [],\n      };\n\n      object.children.forEach((child) => {\n        node.nodes.push(traverse(child));\n      });\n\n      if (\"material\" in object && object.material) {\n        const mats: Material[] = Array.isArray(object.material)\n          ? object.material\n          : [object.material];\n        mats.forEach((mat) => {\n          /**\n           * Ensure that a material is registered only once to avoid duplicate entry\n           */\n          if (!materialsMap.has(mat.uuid)) {\n            materialsMap.set(mat.uuid, {\n              id: mat.uuid,\n              label: mat.name == \"\" ? mat.type : mat.name,\n              type: \"material\",\n              nodes: [],\n            });\n          }\n        });\n      }\n\n      return node;\n    };\n\n    scene.children.forEach((child) => {\n      objects.push(traverse(child));\n    });\n\n    return {\n      Objects: objects,\n      Materials: Array.from(materialsMap.values()),\n    };\n  }\n\n  protected renderTree(scene: Scene) {\n    this.treeView = this.collectSceneData(scene);\n\n    const treeNode = this.root.querySelector(\".tree-view\")!;\n    treeNode.innerHTML = ``;\n\n    this.addCategory(\"Objects\", treeNode, this.treeView.Objects);\n    this.addCategory(\"Materials\", treeNode, this.treeView.Materials);\n  }\n\n  private addCategory(label: string, treeRoot: Element, nodes: TreeNode[]) {\n    const li = document.createElement(\"li\");\n    li.classList.add(\"category\", \"collapsed\");\n\n    const header = document.createElement(\"div\");\n    header.classList.add(\"category-toggle\");\n    header.textContent = `⮞ ${label}`;\n\n    header.addEventListener(\"click\", (e) => {\n      li.classList.toggle(\"collapsed\");\n      const isCollapsed = li.classList.contains(\"collapsed\");\n      header.textContent = isCollapsed ? `⮞ ${label}` : `▼ ${label}`;\n    });\n\n    const nodeList = document.createElement(\"ul\");\n    nodeList.classList.add(\"category-content\");\n    nodes.forEach((node) => {\n      nodeList.appendChild(this.renderTreeNode(node));\n    });\n\n    li.appendChild(header);\n    li.appendChild(nodeList);\n    treeRoot.appendChild(li);\n  }\n\n  private renderTreeNode(node: TreeNode): HTMLElement {\n    const nodeRoot = document.createElement(\"li\");\n    nodeRoot.classList.add(\"tree-node\");\n\n    const label = document.createElement(\"div\");\n    label.classList.add(\"node-label\");\n    label.textContent = `${node.label} (${node.type})`;\n\n    nodeRoot.appendChild(label);\n\n    if (node.nodes.length > 0) {\n      nodeRoot.classList.add(\"collapsed\");\n\n      const ul = document.createElement(\"ul\");\n\n      node.nodes.forEach((node) => {\n        ul.appendChild(this.renderTreeNode(node));\n      });\n\n      label.addEventListener(\"click\", () => {\n        nodeRoot.classList.toggle(\"collapsed\");\n      });\n\n      nodeRoot.appendChild(ul);\n    }\n\n    return nodeRoot;\n  }\n\n  connectedCallback() {\n    const closeButton = this.root.querySelector(\".close-btn\")!;\n\n    closeButton.addEventListener(\"click\", () => {\n      this.toggleCloseButton();\n    });\n  }\n\n  disconnectedCallback() {}\n}\n"]}