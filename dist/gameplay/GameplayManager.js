import {Vector3,Clock,LoadingManager,PMREMGenerator,Euler,CatmullRomCurve3,AnimationMixer,DirectionalLight,AmbientLight,PCFShadowMap,Spherical,ShaderMaterial,MathUtils}from'three';import {FBXLoader}from'three/examples/jsm/loaders/FBXLoader.js';import {DRACOLoader}from'three/examples/jsm/loaders/DRACOLoader.js';import {GLTFLoader}from'three/examples/jsm/loaders/GLTFLoader.js';import {RGBELoader}from'three/examples/jsm/loaders/RGBELoader.js';var ue=()=>{let r=new Map;return {register:(t,d)=>{if(r.has(t))throw new Error(`Error : Redefining the service [${t}]`);r.set(t,d);},get:t=>{let d=r.get(t);if(!d)throw new Error(`Error : Trying to obtain value of an unregistered service ${t}`);return d},has:t=>r.has(t)}},C,S=()=>(C||(C=ue()),C);var w={PATH_TO_MODELS:"/assets/Models/",PATH_TO_HDR:"/assets/HDR/"},E={id:"player",path:w.PATH_TO_MODELS+"player.glb",type:"glb"},G={meshes:[{id:"navigation",path:w.PATH_TO_MODELS+"room.glb",type:"glb"}],hdr:{id:"environment_hdr",path:w.PATH_TO_HDR+"environment.hdr",type:"hdr"}},D={meshes:[{id:"about",path:w.PATH_TO_MODELS+"about.glb",type:"glb"}]},N={meshes:[{id:"projects",path:w.PATH_TO_MODELS+"projects.glb",type:"glb"}]};var _={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"navigation"}},j={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"about"}},F={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"projects"}};var V=({loadingManager:r,scene:a,storageManager:e})=>{let o=new FBXLoader(r),t=async s=>{try{let c=await o.loadAsync(s.path);e.getStorage("model").store(s.id,{animations:c.animations,groups:c}),a.add(c);}catch(c){throw new Error(`Error while loading fbx file : ${c}`)}};return {load:async s=>{let c=[];s.forEach(n=>{c.push(t(n));}),await Promise.allSettled(c);}}};var B=({scene:r,loadingManager:a,storageManager:e})=>{let o=new GLTFLoader(a),t=new DRACOLoader;t.setDecoderPath("/public/draco/"),o.setDRACOLoader(t);let d=async c=>{try{let n=await o.loadAsync(c.path);e.getStorage("model").store(c.id,{animations:n.animations,groups:n.scene}),r.add(n.scene);}catch(n){throw new Error(`Errr occuerd while loading a glb file : ${n}`)}};return {load:async c=>{let n=[];c.forEach(u=>{n.push(d(u));}),await Promise.allSettled(n);}}};var K=({loadingManager:r,renderer:a,scene:e})=>{let o=new PMREMGenerator(a),t=new RGBELoader(r),d=async n=>new Promise((u,l)=>{console.log("path",n.path),t.load(n.path,(i,m)=>{let M=o.fromEquirectangular(i).texture;i.dispose(),e.environment=M,l();},void 0,i=>{u();});}),s=async n=>{let u=[];n.forEach(async l=>{u.push(d(l));}),await Promise.allSettled(u);};return {load:s}};var H=({scene:r,renderer:a,loaderEventBus:e,stateManager:o,storageManager:t})=>{let d=new LoadingManager,s=false,[c,n,u]=[B({scene:r,loadingManager:d,storageManager:t}),V({scene:r,loadingManager:d,storageManager:t}),K({scene:r,loadingManager:d,renderer:a})],l={glb:[],fbx:[],hdr:[]},i=()=>{d.onStart=(v,p,h)=>{e.emit({type:"load:start",url:v,loaded:p,total:h}),o.loading.setState({loading:{active:true,progress:0}});},d.onProgress=(v,p,h)=>{e.emit({type:"load:progress",url:v,loaded:p,total:h}),o.loading.setState({loading:{active:true,progress:p/h}});},d.onLoad=()=>{e.emit({type:"load:complete"});},d.onError=v=>{e.emit({type:"load:error",url:v});},s=true;},m=v=>{switch(v.type){case "glb":l.glb.push(v);break;case "fbx":l.fbx.push(v);break;case "hdr":l.hdr.push(v);break;}},M=v=>{v.forEach(p=>{m(p);});};return {configure:()=>{i();},load:async v=>{if(!s)throw new Error("Error: Trying to load from loader before configuring it");let p=[];return M(v),p.push(c.load(l.glb)),p.push(n.load(l.fbx)),p.push(u.load(l.hdr)),await Promise.allSettled(p),l.fbx=[],l.glb=[],l.hdr=[],{success:[],error:[]}},dispose:()=>{}}};var W=r=>{let{camera:a}=r,o=new Vector3(0,1,2);return {mount:()=>{},activate:()=>{a.position.set(o.x,1,o.z),a.rotation.set(0,0,0,"XYZ");},deactivate:()=>{},unmount:()=>{}}};var U=({logger:r,reference:a,storage:e})=>{let o=null;return {mount:()=>{if(o=e.getStorage("model").retrieve(a.storageId)?.groups.getObjectByName(a.id),!o){console.error(`Cant get ground mesh from the id : ${a.id}`);return}o.material=o.material.clone(),o.receiveShadow=true,o.material.needsUpdate=true,o.material.opacity=.15,o.material.transparent=true,r.onMount({origin:"about-ground"});},actiavte:()=>{},deactivate:()=>{},unmount:()=>{}}};var $=({renderer:r,scene:a})=>{let e,o;return {mount:()=>{e=new DirectionalLight(16777215,5),e.castShadow=true,e.position.set(0,2,0),e.target.position.set(0,1,0),e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.1,e.shadow.camera.far=50,e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10,o=new AmbientLight(16777215),r.shadowMap.enabled=true,r.shadowMap.type=PCFShadowMap;},activate:()=>{e&&a.add(e),o&&a.add(o);},deactivate:()=>{e&&a.remove(e),o&&a.remove(o);},unmount:()=>{}}};var X=({logger:r,reference:a,scene:e,storage:o})=>{let t,d,s=i=>{i.traverse(m=>{m.castShadow=true;});};return {mount:()=>{try{r.onMount({origin:"about-room-player"});let i=e.getObjectByName(a.id);if(!i)throw new Error(`player doesn't exist for the id ${a.id}`);t={playerRoot:i},d={mixer:new AnimationMixer(i)};}catch(i){console.error(`Player mesh cant be obtained :${i}`);}},activate:()=>{t.playerRoot&&(t.playerRoot.rotation.set(0,-Math.PI/4,0,"XYZ"),t.playerRoot.castShadow=true,s(t.playerRoot),t.playerRoot.position.set(1.5,0,0));},deactiavte:()=>{},unmount:()=>{t.playerRoot&&t.playerRoot.position.set(1.5,0,0);}}};var k=({ground:r,player:a})=>{let e=S(),[o,t,d]=[e.get("GlobalStorageManager"),e.get("Logger"),e.get("ThreeJSContextManager")],{scene:s,camera:c,orbit:n,renderer:u}={scene:d.get("scene"),camera:d.get("camera"),orbit:d.get("orbit"),renderer:d.get("renderer")},l={camera:W({camera:c}),player:X({logger:t,reference:a,scene:s,storage:o}),ground:U({logger:t,reference:r,storage:o}),lighting:$({renderer:u,scene:s})},i=null;return {mount:()=>{t.onMount({origin:"about-room"}),l.ground.mount(),l.player.mount(),l.lighting.mount(),i=o.getStorage("model").retrieve(r.storageId)?.groups??null;},setActive:()=>{i&&(i.visible=true),n.enabled=false,l.camera.activate(),l.lighting.activate(),l.player.activate();},update:v=>{},setDeactive:()=>{i&&(i.visible=false),l.lighting.deactivate();},unmount:()=>{l.player.unmount();},isLoaded:false}};var x={DISTANCE:3,HEIGHT_OFFSET:2,PITCH_MIN:0,PITH_MAX:Math.PI/2,SMOOTHING:.1},z=new Vector3(0,0,0),R=new Vector3(0,0,0),I=new Vector3(0,0,0);function we(r,a){return {yaw:MathUtils.euclideanModulo(r,Math.PI*2),pitch:MathUtils.clamp(a,x.PITCH_MIN,x.PITH_MAX)}}function Ae(r){return R.set(0,0,0),R.setFromSpherical(r),R.y+=x.HEIGHT_OFFSET,R}function Le(r,a,e){return r.lerp(a,e)}var J=({camera:r})=>{let e={mode:"thirdPerson",rotation:{pitch:Math.PI/2,yaw:0},spherical:new Spherical(x.DISTANCE,Math.PI/2,0)},o=m=>{e.mode=m;},t=()=>{},d=()=>{r.position.set(1,2,3);},s=m=>{e.rotation.yaw+=m.yaw,e.rotation.pitch+=m.pitch;let M=we(e.rotation.yaw,e.rotation.pitch);e.rotation.yaw=M.yaw,e.rotation.pitch=M.pitch;},c=m=>{e.spherical.theta=e.rotation.yaw,e.spherical.phi=e.rotation.pitch,R.copy(Ae(e.spherical)),z.copy(m.playerPosition).add(R),r.position.copy(Le(r.position,z,x.SMOOTHING)),I.copy(m.playerPosition),I.y+=x.HEIGHT_OFFSET,r.lookAt(I);},n=m=>{r.position.copy(m),r.rotation.set(e.rotation.pitch,e.rotation.yaw,0);};return {setMode:o,update:m=>(s(m.rotationDelta),e.mode==="thirdPerson"?c(m):n(m.playerPosition),{rotation:r.rotation}),mount:t,activate:d,deactivate:()=>{},unmount:()=>{}}};var Z=`
    precision highp float;

    varying vec2 vUV;

    float line(vec2 uv,float lineWidth){

       
        float lineAA=fwidth(uv.x);
 
        float lineUV=1.0-abs(fract(uv.x)*2.0-1.0);

        return smoothstep(lineWidth+lineAA,lineWidth-lineAA,lineUV);
    }  

    float grid(vec2 uv,float lineWidth){

        vec2 uvDeriv=fwidth(uv);
        vec2 drawWidth=max(vec2(lineWidth),uvDeriv);
        vec2 lineAA=uvDeriv*1.5;
 
        vec2 gridUV=1.0-abs(fract(uv)*2.0-1.0);

        vec2 gridLines=smoothstep(drawWidth+lineAA,drawWidth-lineAA,gridUV);
        gridLines*=clamp(lineWidth/drawWidth,0.0,1.0);

        return mix(gridLines.x,1.0,gridLines.y);
    } 

    void main(){
        vec2 st=vUV*1500.0;
       
        gl_FragColor = vec4(vec3(grid(st,0.01)),1.0);
    }

`;var q=`
    precision highp float;

    

    varying vec2 vUV;
    varying vec4 vWorldPos; 

    void main(){
        vUV=uv;
        vWorldPos=modelViewMatrix*vec4(position,1.0);

        gl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);
    }

`;var Q=r=>{let a=new ShaderMaterial({uniforms:{time:{value:1},cameraPos:{value:r.camera.position},fadeNear:{value:r.fadeNear},fadeFar:{value:r.fadeFar}},vertexShader:q,fragmentShader:Z});return {mat:a,update:o=>{a.uniforms.cameraPos.value=o;}}};var ee=({logger:r,references:a,storage:e,camera:o})=>{let t=null,d=null;return {mount:()=>{if(t=e.getStorage("model").retrieve(a.storageId)?.groups.getObjectByName(a.id)??null,!t){console.error(`Cant get ground mesh from the id : ${a.id} ${a.storageId}`);return}d=Q({camera:o,fadeNear:.1,fadeFar:1}),t.material=d.mat,r.onMount({origin:"Navigation-Ground"});},update:()=>{d?.update(o.position);},activate:()=>{},deactivate:()=>{},unmount:()=>{}}};var te=({mixer:r,actions:a,crossFadeDuration:e=.3})=>{let o=null,d=null;return {play:(l,i=0)=>{if(o===l)return;let m=a[l];m&&(m.reset(),m.play(),d?.crossFadeTo(m,e,false),d=m,o=l);},getCurrentAnimation:()=>o,stop:()=>{},update:l=>{l!==void 0&&r.update(l);}}};var Ie=r=>({enter:t=>{console.log("enter idle"),r.animationController.play(r.animationId);},execute:t=>{t.isMoving()&&(t.isShiftPressed()?t.changeState("Run"):t.changeState("Walk"));},exit:t=>{console.log("exit idle");}}),Oe=r=>({enter:t=>{console.log("enter walk"),r.animationController.play(r.animationId);},execute:t=>{t.isMoving()?t.isShiftPressed()&&t.changeState("Run"):t.changeState("Idle");},exit:t=>{console.log("exit walk");}}),Te=r=>({enter:t=>{console.log("enter run"),r.animationController.play(r.animationId);},execute:t=>{t.isMoving()?t.isShiftPressed()||t.changeState("Walk"):t.changeState("Idle");},exit:t=>{console.log("exit run");}}),oe=({inputs:r,animationController:a})=>{let {keyboard:o}={mouse:r.getController("mouse"),keyboard:r.getController("keyboard")},{idle:d,walk:s,run:c}={idle:Ie({animationController:a,animationId:"Idle"}),walk:Oe({animationController:a,animationId:"Walk"}),run:Te({animationController:a,animationId:"Run"})},n=d,u="Idle",l=p=>{n.execute(y),a.update(p);},i=()=>!!(o?.isKeyPressed("w")||o?.isKeyPressed("a")||o?.isKeyPressed("s")||o?.isKeyPressed("d")),m=()=>o?.isKeyPressed("shift")??false,M=p=>{switch(p){case "Idle":return d;case "Walk":return s;case "Run":return c;default:return d}},b=p=>{u!==p&&(u=p,n.exit(y),n=M(p),n.enter(y));},f=()=>{n.enter(y);},y={changeState:b,isMoving:i,isShiftPressed:m};return {mount:f,update:l,unmount:()=>{}}};var re={MOVEMENT_ACCELERATION:.05,MAX_VELOCITY:.05},ae=({reference:r,storage:a,InputManager:e})=>{let o,t={direction:new Vector3(0,0,-1),velocity:new Vector3(0,0,0),rotationApplied:{pitch:0,yaw:0}},d={inputDirection:new Vector3(0,0,0)},s={player:null},c=()=>{try{let f=a.getStorage("model").retrieve(r.storageId);if(!f)throw new Error(`player doesn't exist for the id ${r.storageId}`);let y=f?.groups,v=f?.animations,p=new AnimationMixer(y),h=te({mixer:p,actions:{Idle:p.clipAction(v[0]),Walk:p.clipAction(v[3]),Run:p.clipAction(v[1])},crossFadeDuration:.3}),g=oe({animationController:h,inputs:e});g.mount(),s={player:y},o={input:{mouse:e.getController("mouse"),keyboard:e.getController("keyboard")},animation:h,fsm:g};}catch(f){console.error(`Player mesh cant be obtained :${f}`);}},n=f=>{!f||!s.player||(t.rotationApplied=f.getRotation(),s.player.rotation.y+=t.rotationApplied.yaw);},u=(f,y)=>{if(!f||!s.player)return;let p=.001,{inputDirection:h}=d;if(h.set(0,0,0),f.isKeyPressed("w")&&(h.z-=1),f.isKeyPressed("s")&&(h.z+=1),f.isKeyPressed("a")&&(h.x-=1),f.isKeyPressed("d")&&(h.x+=1),h.length()>0)h.applyQuaternion(s.player.quaternion),h.normalize(),t.velocity.add(h.multiplyScalar(re.MOVEMENT_ACCELERATION*y)),t.velocity.clampLength(0,re.MAX_VELOCITY);else if(h.length()==0&&t.velocity.length()>0){let g=Math.exp(-5*y);t.velocity.multiplyScalar(g),t.velocity.lengthSq()<p*p&&t.velocity.set(0,0,0);}s.player.position.add(t.velocity);},l=f=>{n(o.input.mouse),u(o.input.keyboard,f);};return {mount:c,activate:()=>{},deactivate:()=>{},update:f=>(l(f),o.fsm.update(f),{position:s.player?.position??new Vector3(0,0,0),rotation:s.player?.rotation??new Euler(0,0,0,"XYZ"),rotationDelta:t.rotationApplied}),unmount:()=>{}}};var ne=({player:r,ground:a})=>{let e=S(),[o,t,d,s,c]=[e.get("Logger"),e.get("GlobalStorageManager"),e.get("EventBusManager"),e.get("InputManager"),e.get("ThreeJSContextManager")],n={camera:J({camera:c.get("camera")}),player:ae({reference:r,InputManager:s,storage:t}),ground:ee({camera:c.get("camera"),logger:o,references:a,storage:t})},u=null,i=null,m=false;return {mount:()=>{m||!n||(o.onMount({origin:"Navigation Room"}),u={player:{position:new Vector3(0,0,0),rotation:new Euler(0,0,0),rotationDelta:{yaw:0,pitch:0}}},i=t.getStorage("model").retrieve(a.storageId)??null,n.player.mount(),n.ground.mount(),n.camera.mount(),m=true);},update:p=>{!m||!n||!u||(c.get("orbit").update(),u.player=n.player.update(p),n.camera.update({playerPosition:u.player.position,rotationDelta:u.player.rotationDelta}));},unmount:()=>{!m||!n||(o.onUnmount({origin:"Navigation Room"}),n.player.unmount(),n.ground.unmount(),n=null,i=null);},setActive:()=>{!i||!n||(i.groups.visible=true,c.get("orbit").enabled=false,n.camera.activate(),n.ground.activate(),n.player.activate());},setDeactive:()=>{!i||!n||(i.groups.visible=false,n.camera.deactivate(),n.ground.deactivate(),n.player.deactivate());},isLoaded:false}};var ie=({camera:r,eventBusManager:a,orbit:e,scene:o})=>{let t=[new Vector3(0,2,10),new Vector3(0,2,5),new Vector3(0,2,3),new Vector3(0,2,2),new Vector3(0,2,1),new Vector3(0,2,0),new Vector3(0,2,-1),new Vector3(0,1,-1),new Vector3(0,1,-1.5),new Vector3(0,1,-2)],d=new CatmullRomCurve3(t),s=0,c=false;return {mount:()=>{s=0;},activate:()=>{e.enabled=false,r.position.set(0,2.5,10),r.near=.001,r.far=1e3;},update:M=>{if(!c&&s>1&&(c=true,e.enabled=true,a.viewBus.emit({type:"project-screen:show",elementId:"project-screen"}),console.log("event emitted view event")),!c&&(s+=M*.1,s<=.9)){let b=d.getPointAt(s),f=d.getPointAt(s+.1);f.z-=.1,r.position.copy(b),r.lookAt(f);}},deactivate:()=>{},unmount:()=>{}}};var se=({reference:r,logger:a,storage:e})=>{let o=null;return {mount:()=>{let n=e.getStorage("model").retrieve(r.storageId)?.groups;if(o=n?.getObjectByName(r.id),!o){console.error(`Cant get ground mesh from the id : ${r.id}`);return}o.material=o.material.clone(),o.receiveShadow=true,o.material.needsUpdate=true,o.material.opacity=1,o.material.transparent=true;let u=["sky","ground"];n?.traverse(l=>{u.includes(l.name)||(l.castShadow=true);}),a.onMount({origin:"about-ground"});},actiavte:()=>{},deactivate:()=>{},unmount:()=>{}}};var ce=({renderer:r,scene:a})=>{let e,o;return {mount:()=>{e=new DirectionalLight(16777215,5),e.castShadow=true,e.position.set(0,1,.5),e.target.position.set(0,0,0),e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.1,e.shadow.camera.far=50,e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10,o=new AmbientLight(16777215),r.shadowMap.enabled=true,r.shadowMap.type=PCFShadowMap;},activate:()=>{e&&a.add(e),o&&a.add(o);},deactivate:()=>{e&&a.remove(e),o&&a.remove(o);},unmount:()=>{}}};var le=({logger:r,reference:a,storage:e})=>{let o,t=[],d=i=>{i.traverse(m=>{m.castShadow=true;});};return {mount:()=>{try{let i=e.getStorage("model").retrieve(a.storageId)?.groups,m=e.getStorage("model").retrieve(a.storageId)?.animations??[];if(!i)throw new Error(`player doesn't exist for the id ${a.storageId}`);o={playerRoot:i};let M=new AnimationMixer(i);M.clipAction(m[2]).play(),t.push(M),r.onMount({origin:"Project-Room-Player"});}catch(i){console.error(`Player mesh cant be obtained :${i}`);}},activate:()=>{o.playerRoot&&(o.playerRoot.rotation.set(0,0,0,"XYZ"),o.playerRoot.castShadow=true,d(o.playerRoot));},update:i=>{t.forEach(m=>{m.update(i);});},deactiavte:()=>{},unmount:()=>{}}};var de=({player:r,ground:a})=>{let e=S(),[o,t,d,s]=[e.get("GlobalStorageManager"),e.get("ThreeJSContextManager"),e.get("EventBusManager"),e.get("Logger")],{scene:c,camera:n,orbit:u,renderer:l}={scene:t.get("scene"),camera:t.get("camera"),orbit:t.get("orbit"),renderer:t.get("renderer")},i={camera:ie({camera:n,eventBusManager:d,orbit:u,scene:c}),player:le({logger:s,reference:r,storage:o}),ground:se({logger:s,reference:a,storage:o}),lighting:ce({renderer:l,scene:c})},m=null;return {mount:()=>{i.ground.mount(),i.player.mount(),i.camera.mount(),i.lighting.mount(),m=o.getStorage("model").retrieve(a.storageId)?.groups??null,s.onMount({origin:"Projects"});},setActive:()=>{m&&(m.visible=true),i.camera.activate(),i.lighting.activate(),i.player.activate();},update:p=>{i.player.update(p),i.camera.update(p);},setDeactive:()=>{m&&(m.visible=false),i.lighting.deactivate();},unmount:()=>{},isLoaded:false}};var me=()=>{let r=S(),[a,e,o,t,d]=[r.get("GlobalStorageManager"),r.get("Logger"),r.get("EventBusManager"),r.get("ThreeJSContextManager"),r.get("GlobalStateManager")],s=null,c={navigation:null,about:null,projects:null},n={navigation:G,about:D,projects:N},u=null,l=null,i=()=>{try{s=H({storageManager:a,stateManager:d,loaderEventBus:o.loadingBus,renderer:t.get("renderer"),scene:t.get("scene")}),s?.configure();}catch(g){throw new Error(`[Gameplay] Couldnt create and initailize the loader due to ${g}`)}},m=g=>{switch(g){case "navigation":return c[g]=ne(_),c[g];case "about":return c[g]=k(j),c[g];case "projects":return c[g]=de(F),c[g];default:throw new Error(`Unknown Room key ${g}`)}},M=async g=>{if(!s)return;if(!n[g])throw new Error("[Room Controller] sufficient asset meta data is not given.");if(!c[g]){let A=m(g);console.log("load room",n[g]);let T=[...n[g].meshes];n[g].hdr&&T.push(n[g].hdr),await s.load(T),A&&(A.mount(),A.isLoaded=true,u=A);}},b=async g=>{l!==g&&(l!=null&&c[l]!=null&&c[l].setDeactive(),await M(g),c[g]&&c[g].setActive(),l=g);},f=async()=>{e.onMount({origin:"Room Controller"}),i(),await s?.load([E]),await M("navigation"),await b("navigation");},y=g=>{u?.update(g);},v=()=>{s?.dispose(),Object.values(c).forEach(g=>{g?.unmount();}),e.onUnmount({origin:"room-controller"});},p=g=>{o.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),Promise.allSettled([b(g)]).then(()=>{o.loadingBus.emit({type:"load:complete"});});},h=()=>{l&&u?.setDeactive();};return {mount:f,switchRoom:{navigation:()=>p("navigation"),about:()=>p("about"),projects:()=>p("projects"),default:()=>h()},update:y,unmount:v}};var Qo=()=>{let r=S(),[a,e,o]=[r.get("EventBusManager"),r.get("Logger"),r.get("InputManager")],t=new Clock,d={deltaTime:0},s={deltaTime:0},c=false,n=me(),u=()=>{a.displayBus.on("about:show",n.switchRoom.about),a.displayBus.on("about:hide",n.switchRoom.default),a.displayBus.on("projects:show",n.switchRoom.projects),a.displayBus.on("projects:hide",n.switchRoom.default),a.displayBus.on("home:show",n.switchRoom.navigation),a.displayBus.on("home:hide",n.switchRoom.default);},l=async()=>{c||(await n.mount(),u(),c=true,window.addEventListener("keyup",f=>{console.log(f);}));},i=()=>{s.deltaTime=t.getDelta(),!isNaN(s.deltaTime)&&s.deltaTime!==void 0&&(d.deltaTime=s.deltaTime);},m=()=>{i(),n.update(d.deltaTime??0);};return {onMount:l,update:m,onUnmount:()=>{}}};export{Qo as createGameplayManager};//# sourceMappingURL=GameplayManager.js.map
//# sourceMappingURL=GameplayManager.js.map