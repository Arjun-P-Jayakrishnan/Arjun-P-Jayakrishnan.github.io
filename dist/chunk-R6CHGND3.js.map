{"version":3,"sources":["../src/gameplay/rooms/about/room.ts"],"names":["createAboutRoom","ground","player","serviceRegistry","getServiceRegistry","storage","logger","context","scene","camera","orbit","renderer","components","createCameraManager","createPlayer","createGround","createLighting","group","deltaTime"],"mappings":"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","file":"chunk-R6CHGND3.js","sourcesContent":["import { Group, Object3DEventMap } from \"three\";\n\nimport { getServiceRegistry } from \"engine/core/ServiceRegistry\";\nimport { ModelIdentifier, Room } from \"types/rooms.types\";\nimport { CameraManager, createCameraManager } from \"./camera\";\nimport { createGround, Ground } from \"./ground\";\nimport { createLighting, Lighting } from \"./lights\";\nimport { createPlayer, Player } from \"./player\";\n\nexport interface AboutRoomProps {\n  player: ModelIdentifier;\n  ground: ModelIdentifier;\n}\n\ninterface Components {\n  camera: CameraManager;\n  player: Player;\n  ground: Ground;\n  lighting: Lighting;\n}\n\nexport const createAboutRoom = ({ ground, player }: AboutRoomProps): Room => {\n  //====References====\n  const serviceRegistry = getServiceRegistry();\n  const [storage, logger, context] = [\n    serviceRegistry.get(\"GlobalStorageManager\"),\n    serviceRegistry.get(\"Logger\"),\n    serviceRegistry.get(\"ThreeJSContextManager\"),\n  ];\n\n  const { scene, camera, orbit, renderer } = {\n    scene: context.get(\"scene\")!,\n    camera: context.get(\"camera\")!,\n    orbit: context.get(\"orbit\")!,\n    renderer: context.get(\"renderer\")!,\n  };\n\n  //===Local===\n  const components: Components = {\n    camera: createCameraManager({ camera: camera, scene: scene }),\n    player: createPlayer({ logger, reference: player, scene, storage }),\n    ground: createGround({ logger, reference: ground, storage }),\n    lighting: createLighting({ renderer, scene }),\n  };\n\n  let group: Nullable<Group<Object3DEventMap>> = null;\n\n  const mount = () => {\n    logger.onMount({ origin: \"about-room\" });\n    components.ground.mount();\n    components.player.mount();\n    components.camera.mount();\n    components.lighting.mount();\n    group =\n      storage.getStorage(\"model\").retrieve(ground.storageId)?.groups ?? null;\n  };\n\n  const activate = () => {\n    if (group) group.visible = true;\n\n    orbit.enabled = false;\n    components.camera.activate();\n    components.ground.actiavte();\n    components.lighting.activate();\n    components.player.activate();\n  };\n\n  const update = (deltaTime: number) => {\n    // components.camera.update(deltaTime);\n  };\n\n  const deactivate = () => {\n    if (group) group.visible = false;\n\n    components.camera.deactivate();\n    components.ground.deactivate();\n    components.lighting.deactivate();\n    components.player.deactiavte();\n  };\n\n  const unmount = () => {\n    components.camera.unmount();\n    components.ground.unmount();\n    components.lighting.unmount();\n    components.player.unmount();\n  };\n\n  return {\n    mount: mount,\n    setActive: activate,\n    update: update,\n    setDeactive: deactivate,\n    unmount: unmount,\n    isLoaded: false,\n  };\n};\n"]}