import {a as a$3}from'./chunk-Z6DMPIJV.js';import {a as a$5}from'./chunk-7RWTZPGD.js';import {a as a$4}from'./chunk-R6CHGND3.js';import {a}from'./chunk-P6US56ME.js';import {a as a$2}from'./chunk-JZJLBSDF.js';import {a as a$1,d,c,b}from'./chunk-LBLZSNCB.js';import {c as c$1,b as b$1,a as a$6}from'./chunk-V5XTZ25L.js';var $=()=>{let r=a(),[_,u,s,c$2,N]=[r.get("GlobalStorageManager"),r.get("Logger"),r.get("EventBusManager"),r.get("ThreeJSContextManager"),r.get("GlobalStateManager")],e=null,t={navigation:null,about:null,projects:null},n={navigation:b,about:c,projects:d},m=null,a$7=null,P=()=>{try{e=a$2({storageManager:_,stateManager:N,loaderEventBus:s.loadingBus,renderer:c$2.get("renderer"),scene:c$2.get("scene")}),e?.configure();}catch(o){throw new Error(`[Gameplay] Couldnt create and initailize the loader due to ${o}`)}},K=o=>{switch(o){case "navigation":return t[o]=a$5(a$6),t[o];case "about":return t[o]=a$4(b$1),t[o];case "projects":return t[o]=a$3(c$1),t[o];default:throw new Error(`Unknown Room key ${o}`)}},R=async o=>{if(!e)return;if(!n[o])throw new Error("[Room Controller] sufficient asset meta data is not given.");if(!t[o]){let i=K(o);console.log("load room",n[o]);let g=[...n[o].meshes];n[o].hdr&&g.push(n[o].hdr),await e.load(g),i&&(i.mount(),i.isLoaded=true,m=i);}},d$1=async o=>{a$7!==o&&(a$7!=null&&t[a$7]!=null&&t[a$7].setDeactive(),await R(o),t[o]&&t[o].setActive(),a$7=o);},C=async()=>{u.onMount({origin:"Room Controller"}),P(),await e?.load([a$1]),await R("navigation"),await d$1("navigation");},j=o=>{m?.update(o);},y=()=>{e?.dispose(),Object.values(t).forEach(o=>{o?.unmount();}),u.onUnmount({origin:"room-controller"});},l=o=>{s.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),Promise.allSettled([d$1(o)]).then(()=>{s.loadingBus.emit({type:"load:complete"});});},B=()=>{a$7&&m?.setDeactive();};return {mount:C,switchRoom:{navigation:()=>l("navigation"),about:()=>l("about"),projects:()=>l("projects"),default:()=>B()},update:j,unmount:y}};export{$ as a};//# sourceMappingURL=chunk-CO6WVWOP.js.map
//# sourceMappingURL=chunk-CO6WVWOP.js.map