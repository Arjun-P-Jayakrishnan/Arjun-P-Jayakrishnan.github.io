{"version":3,"sources":["../src/graphics/internal/internal.ts"],"sourcesContent":["import { AxesHelper, PerspectiveCamera, Scene, WebGLRenderer } from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\n\nexport interface ThreeJSRenderProps {\n  /**\n   * Properties for camera\n   */\n  camera: {\n    fov?: number;\n    aspect?: number;\n    near?: number;\n    far?: number;\n  };\n  /**\n   * Tag to which renderer has to be attached\n   */\n  domMountTag: string;\n}\n\nexport interface ThreeJsRenderReference {\n  scene: Scene;\n  camera: PerspectiveCamera;\n  renderer: WebGLRenderer;\n  controls: OrbitControls;\n\n  /**\n   * @description Mount\n   */\n  mount: () => void;\n  /**\n   * @description\n   * @param loop the callback for updating\n   */\n  register: (loop: () => void) => void;\n  /**\n   * @description Loop\n   */\n  render: () => void;\n  /**\n   * @description UnMount\n   */\n  dispose: (disposeCallbacks: Array<() => void>) => void;\n}\n\n/**\n * @description Creates a threejs environment in which further additions can be made\n * @param props properties that define the setup of game engine\n * @returns Render Lifecycle methods\n */\nexport const createThreeJsInstance = (\n  props: ThreeJSRenderProps\n): ThreeJsRenderReference => {\n  //Local references\n\n  let scene: Scene = new Scene();\n\n  let camera: PerspectiveCamera = new PerspectiveCamera(\n    props.camera.fov,\n    props.camera.aspect,\n    props.camera.near,\n    props.camera.far\n  );\n\n  let renderer: WebGLRenderer = new WebGLRenderer({ antialias: true });\n\n  let controls: OrbitControls = new OrbitControls(camera, renderer.domElement);\n\n  let animationLoop: () => void | undefined;\n\n  /**\n   * @description add the renderer so that it can display the 3d\n   * @param tag the dom tag to which the renderer is to be attached\n   */\n  const _mountRenderer = (tag: string) => {\n    const container = document.getElementById(tag);\n\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    if (container) {\n      container.appendChild(renderer.domElement);\n    } else {\n      console.warn(`Could not find element with selector tag : ${tag}`);\n    }\n  };\n\n  /**\n   * @description setup initial properties of orbital controls\n   */\n  const _configureControls = () => {\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.25;\n    controls.screenSpacePanning = false;\n    controls.maxPolarAngle = Math.PI / 2;\n  };\n\n  const addAxesHelper = () => {\n    const axes_helper = new AxesHelper();\n    scene.add(axes_helper);\n  };\n\n  const mount = () => {\n    _mountRenderer(props.domMountTag);\n    _configureControls();\n\n    camera.position.set(0, 0, 0.5);\n    scene.add(camera);\n\n    addAxesHelper();\n  };\n\n  const register = (loop: () => void) => {\n    animationLoop = loop;\n  };\n\n  /**\n   * @description Life cycle method similar to update\n   */\n  const render = () => {\n    //Recursive callback function\n    requestAnimationFrame(render);\n\n    controls.update();\n\n    if (animationLoop) {\n      animationLoop();\n    }\n\n    //Render scene from cameras perspective\n    renderer.render(scene, camera);\n  };\n\n  /**\n   * @description Life cycle method similar to UnMount\n   * @param disposeCallbacks array of dispose callbacks to be executed\n   */\n  const dispose = (disposeCallbacks: Array<() => void>) => {\n    disposeCallbacks.forEach((fn) => fn());\n\n    renderer.dispose();\n    controls.dispose();\n  };\n\n  return Object.freeze({\n    scene: scene,\n    camera: camera,\n    controls: controls,\n    renderer: renderer,\n\n    mount: mount,\n    register: register,\n    render: render,\n    dispose: dispose,\n  });\n};\n"],"mappings":"AAAA,OAAS,cAAAA,EAAY,qBAAAC,EAAmB,SAAAC,EAAO,iBAAAC,MAAqB,QACpE,OAAS,iBAAAC,MAAqB,+CAgDvB,IAAMC,EACXC,GAC2B,CAG3B,IAAIC,EAAe,IAAIL,EAEnBM,EAA4B,IAAIP,EAClCK,EAAM,OAAO,IACbA,EAAM,OAAO,OACbA,EAAM,OAAO,KACbA,EAAM,OAAO,GACf,EAEIG,EAA0B,IAAIN,EAAc,CAAE,UAAW,EAAK,CAAC,EAE/DO,EAA0B,IAAIN,EAAcI,EAAQC,EAAS,UAAU,EAEvEE,EAMEC,EAAkBC,GAAgB,CACtC,IAAMC,EAAY,SAAS,eAAeD,CAAG,EAE7CJ,EAAS,QAAQ,OAAO,WAAY,OAAO,WAAW,EACtDA,EAAS,cAAc,OAAO,gBAAgB,EAE1CK,EACFA,EAAU,YAAYL,EAAS,UAAU,EAEzC,QAAQ,KAAK,8CAA8CI,CAAG,EAAE,CAEpE,EAKME,EAAqB,IAAM,CAC/BL,EAAS,cAAgB,GACzBA,EAAS,cAAgB,IACzBA,EAAS,mBAAqB,GAC9BA,EAAS,cAAgB,KAAK,GAAK,CACrC,EAEMM,EAAgB,IAAM,CAC1B,IAAMC,EAAc,IAAIjB,EACxBO,EAAM,IAAIU,CAAW,CACvB,EAEMC,EAAQ,IAAM,CAClBN,EAAeN,EAAM,WAAW,EAChCS,EAAmB,EAEnBP,EAAO,SAAS,IAAI,EAAG,EAAG,EAAG,EAC7BD,EAAM,IAAIC,CAAM,EAEhBQ,EAAc,CAChB,EAEMG,EAAYC,GAAqB,CACrCT,EAAgBS,CAClB,EAKMC,EAAS,IAAM,CAEnB,sBAAsBA,CAAM,EAE5BX,EAAS,OAAO,EAEZC,GACFA,EAAc,EAIhBF,EAAS,OAAOF,EAAOC,CAAM,CAC/B,EAaA,OAAO,OAAO,OAAO,CACnB,MAAOD,EACP,OAAQC,EACR,SAAUE,EACV,SAAUD,EAEV,MAAOS,EACP,SAAUC,EACV,OAAQE,EACR,QAhBeC,GAAwC,CACvDA,EAAiB,QAASC,GAAOA,EAAG,CAAC,EAErCd,EAAS,QAAQ,EACjBC,EAAS,QAAQ,CACnB,CAYA,CAAC,CACH","names":["AxesHelper","PerspectiveCamera","Scene","WebGLRenderer","OrbitControls","createThreeJsInstance","props","scene","camera","renderer","controls","animationLoop","_mountRenderer","tag","container","_configureControls","addAxesHelper","axes_helper","mount","register","loop","render","disposeCallbacks","fn"]}