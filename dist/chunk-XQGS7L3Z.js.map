{"version":3,"sources":["../src/gameplay/projects/camera.ts"],"names":["createCameraManager","props","camera","orbit","eventBusManager","getGlobalContext","points","Vector3","camPath","CatmullRomCurve3","isComplete","deltaTime","position","lookAt"],"mappings":"iFAkBaA,IAAAA,CAAAA,CAAuBC,GAAsC,CACxE,GAAM,CAAE,MAAAC,CAAAA,CAAAA,CAAQ,MAAAC,CAAM,CAAA,CAAIF,EACpB,CAAE,eAAA,CAAAG,CAAgB,CAAIC,CAAAA,CAAAA,GAEtBC,CAAoB,CAAA,CACxB,IAAIC,OAAQ,CAAA,CAAA,CAAG,EAAG,EAAE,CAAA,CACpB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,CAAC,CAAA,CACnB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,CAAC,CAAA,CACnB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,CAAC,CAAA,CACnB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,CAAC,CAAA,CACnB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,CAAC,CAAA,CACnB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,EAAE,CAAA,CACpB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,EAAE,CAAA,CACpB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,IAAI,CAAA,CACtB,IAAIA,OAAQ,CAAA,CAAA,CAAG,EAAG,EAAE,CACtB,EAEMC,CAAU,CAAA,IAAIC,iBAAiBH,CAAM,CAAA,CACvC,EAAI,CACJI,CAAAA,CAAAA,CAAsB,MAwC1B,OAAO,CACL,MAvCY,IAAM,CAClB,EAAI,EACN,CAAA,CAsCE,SApCe,IAAM,CACrBP,EAAM,OAAU,CAAA,KAAA,CAChBD,EAAO,QAAS,CAAA,GAAA,CAAI,EAAG,GAAK,CAAA,EAAE,EAC9BA,CAAO,CAAA,IAAA,CAAO,KACdA,CAAO,CAAA,GAAA,CAAM,IACf,CAgCE,CAAA,MAAA,CA9BcS,GAAsB,CAUpC,GATI,CAACD,CAAc,EAAA,CAAA,CAAI,IACrBA,CAAa,CAAA,IAAA,CACbP,EAAM,OAAU,CAAA,IAAA,CAChBC,EAAgB,UAAW,CAAA,IAAA,CAAK,CAC9B,IAAM,CAAA,qBAAA,CACN,UAAW,gBACb,CAAC,GAGC,CAACM,CAAAA,GACH,GAAKC,CAAY,CAAA,EAAA,CAEb,GAAK,EAAK,CAAA,CAAA,CACZ,IAAMC,CAAWJ,CAAAA,CAAAA,CAAQ,WAAW,CAAC,CAAA,CAC/BK,EAASL,CAAQ,CAAA,UAAA,CAAW,EAAI,EAAG,CAAA,CACzCK,EAAO,CAAK,EAAA,EAAA,CACZX,EAAO,QAAS,CAAA,IAAA,CAAKU,CAAQ,CAC7BV,CAAAA,CAAAA,CAAO,OAAOW,CAAM,EACtB,CAEJ,CAUE,CAAA,UAAA,CARiB,IAAM,EAAC,CASxB,QAPc,IAAM,EAQtB,CACF","file":"chunk-XQGS7L3Z.js","sourcesContent":["import { getGlobalContext } from \"@managers/globalContext\";\nimport { CatmullRomCurve3, PerspectiveCamera, Scene, Vector3 } from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\n\nexport interface CameraProps {\n  camera: PerspectiveCamera;\n  scene: Scene;\n  orbit: OrbitControls;\n}\n\nexport interface CameraManager {\n  mount: () => void;\n  activate: () => void;\n  update: (deltaTime: number) => void;\n  deactivate: () => void;\n  unmount: () => void;\n}\n\nexport const createCameraManager = (props: CameraProps): CameraManager => {\n  const { camera, orbit } = props;\n  const { eventBusManager } = getGlobalContext();\n\n  const points: Vector3[] = [\n    new Vector3(0, 2, 10),\n    new Vector3(0, 2, 5),\n    new Vector3(0, 2, 3),\n    new Vector3(0, 2, 2),\n    new Vector3(0, 2, 1),\n    new Vector3(0, 2, 0),\n    new Vector3(0, 2, -1),\n    new Vector3(0, 1, -1),\n    new Vector3(0, 1, -1.5),\n    new Vector3(0, 1, -2),\n  ];\n\n  const camPath = new CatmullRomCurve3(points);\n  let t = 0;\n  let isComplete: boolean = false;\n\n  const mount = () => {\n    t = 0;\n  };\n\n  const activate = () => {\n    orbit.enabled = false;\n    camera.position.set(0, 2.5, 10);\n    camera.near = 0.001;\n    camera.far = 1000;\n  };\n\n  const update = (deltaTime: number) => {\n    if (!isComplete && t > 1) {\n      isComplete = true;\n      orbit.enabled = true;\n      eventBusManager.displayBus.emit({\n        type: \"project-screen:show\",\n        elementId: \"project-screen\",\n      });\n    }\n\n    if (!isComplete) {\n      t += deltaTime * 0.1;\n\n      if (t <= 0.9) {\n        const position = camPath.getPointAt(t);\n        const lookAt = camPath.getPointAt(t + 0.1);\n        lookAt.z -= 0.1;\n        camera.position.copy(position);\n        camera.lookAt(lookAt);\n      }\n    }\n  };\n\n  const deactivate = () => {};\n\n  const unmount = () => {};\n\n  return {\n    mount: mount,\n    activate: activate,\n    update: update,\n    deactivate: deactivate,\n    unmount: unmount,\n  };\n};\n"]}