import {Vector3,Euler}from'three';var u={MOVEMENT_ACCELERATION:.05,MAX_VELOCITY:.05},N=({reference:l,storage:y,InputManager:p})=>{let i,r={direction:new Vector3(0,0,-1),velocity:new Vector3(0,0,0),rotationApplied:{pitch:0,yaw:0}},d={inputDirection:new Vector3(0,0,0)},t={player:null},m=()=>{try{let e=y.getStorage("model").retrieve(l.storageId);if(!e)throw new Error(`player doesn't exist for the id ${l.storageId}`);let a=e?.groups,c=e?.animations;t={player:a},i={input:{mouse:p.getController("mouse"),keyboard:p.getController("keyboard")}};}catch(e){console.error(`Player mesh cant be obtained :${e}`);}},f=e=>{!e||!t.player||(r.rotationApplied=e.getRotation(),t.player.rotation.y+=r.rotationApplied.yaw);},b=(e,a)=>{if(!e||!t.player)return;let s=.001,{inputDirection:o}=d;if(o.set(0,0,0),e.isKeyPressed("w")&&(o.z-=1),e.isKeyPressed("s")&&(o.z+=1),e.isKeyPressed("a")&&(o.x-=1),e.isKeyPressed("d")&&(o.x+=1),o.length()>0)o.applyQuaternion(t.player.quaternion),o.normalize(),r.velocity.add(o.multiplyScalar(u.MOVEMENT_ACCELERATION*a)),r.velocity.clampLength(0,u.MAX_VELOCITY);else if(o.length()==0&&r.velocity.length()>0){let I=Math.exp(-5*a);r.velocity.multiplyScalar(I),r.velocity.lengthSq()<s*s&&r.velocity.set(0,0,0);}t.player.position.add(r.velocity);},g=e=>{f(i.input.mouse),b(i.input.keyboard,e);};return {mount:m,activate:()=>{t.player&&(t.player.position.set(0,0,0),t.player.rotation.set(0,0,0),console.log("actiavting player for navigation",t.player?.position));},deactivate:()=>{},update:e=>(g(e),{position:t.player?.position??new Vector3(0,0,0),rotation:t.player?.rotation??new Euler(0,0,0,"XYZ"),rotationDelta:r.rotationApplied}),unmount:()=>{}}};export{N as a};//# sourceMappingURL=chunk-WZU6CF5S.js.map
//# sourceMappingURL=chunk-WZU6CF5S.js.map