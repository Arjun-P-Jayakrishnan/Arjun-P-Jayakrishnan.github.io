import {a as a$1}from'../../../chunk-OGB6CUJQ.js';import'../../../chunk-4N5VRYQU.js';import'../../../chunk-P5JPHKTW.js';import'../../../chunk-CNBMV74T.js';import'../../../chunk-DEUTJOB7.js';import'../../../chunk-URDWKHZ5.js';import {a as a$2}from'../../../chunk-EC7KCJF4.js';import {a}from'../../../chunk-P6US56ME.js';import {Euler,Vector3}from'three';var D=({reference:i,storage:g,InputManager:s})=>{let l,o,e={player:null},b=a(),p,a$3,m=`player-${i.storageId}`,y={yaw:0,pitch:0};return {mount:()=>{let t=g.getStorage("model").retrieve(i.storageId);if(!t)throw new Error(`Player model not found for id ${i.storageId}`);e.player=t.groups;let r=t.groups;p=b.get("AnimationManager");let n=a$1({id:m,playerObject:r,animations:t.animations});n.playback.onMount(),n.playback.play("Idle"),a$3=n.params,p.addEntity(n),l={input:{mouse:s.getController("mouse"),keyboard:s.getController("keyboard")}},o=a$2({object:e.player,keyboard:l.input.keyboard,mouse:l.input.mouse}),o.initialize(new Vector3(0,0,-1));},activate:()=>{e.player&&(e.player.position.set(0,0,0),e.player.rotation.set(0,0,0));},deactivate:()=>{},update:t=>{if(!o||!e.player)return {position:new Vector3,rotation:new Euler,rotationDelta:{yaw:0,pitch:0}};let r=o.update(t);return a$3.set("speed",r.speed),a$3.set("isMoving",r.isMoving),a$3.set("isRunning",r.isRunning),y.yaw=r.yawDelta,{position:e.player.position,rotation:e.player.rotation,rotationDelta:y}},unmount:()=>{p?.removeEntity(m);}}};export{D as createPlayer};//# sourceMappingURL=player.js.map
//# sourceMappingURL=player.js.map