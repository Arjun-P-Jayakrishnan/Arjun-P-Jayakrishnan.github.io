import {Vector3,Scene,PerspectiveCamera,WebGLRenderer,Clock,LoadingManager,PMREMGenerator,Euler,CatmullRomCurve3,AnimationMixer,DirectionalLight,AmbientLight,PCFShadowMap,Spherical,ShaderMaterial,MathUtils}from'three';import {FBXLoader}from'three/examples/jsm/loaders/FBXLoader.js';import {DRACOLoader}from'three/examples/jsm/loaders/DRACOLoader.js';import {GLTFLoader}from'three/examples/jsm/loaders/GLTFLoader.js';import {RGBELoader}from'three/examples/jsm/loaders/RGBELoader.js';import {OrbitControls}from'three/examples/jsm/controls/OrbitControls.js';var J=()=>({onLoad:a=>{console.log(`\u267B\uFE0F [${a.origin}] is being loaded....`);},onMount:a=>{console.log(`\u2795 [${a.origin}] is being mounted...`);},onUpdate:(a,i)=>{console.log(`\u{1F504} [${i.origin}] is being updated.. with ${a.toFixed(2)}`);},onUnmount:a=>{console.log(`\u2796 [${a.origin}] is being unmounted`);},onDestroy:a=>{console.log(`\u{1F5D1}\uFE0F [${a.origin}] is being disposed`);}});var z=()=>{let o={camera:void 0,orbit:void 0,renderer:void 0,scene:void 0};return {get:r=>{if(!o[r])throw new Error("Error : Accessing context when its not initialized");return o[r]},set:(r,a)=>{if(o[r]!==void 0)throw new Error("Error : Trying to overwrite already initialized context");o[r]=a;},clear:()=>{o={camera:void 0,orbit:void 0,renderer:void 0,scene:void 0};}}};var W=()=>{let o=new Set,n=s=>s.toLowerCase(),e=s=>{o.delete(n(s.key));},t=s=>{o.add(n(s.key));};return {onMount:()=>{window.addEventListener("keyup",e),window.addEventListener("keydown",t);},onUnmount:()=>{window.removeEventListener("keyup",e),window.removeEventListener("keydown",t),o.clear();},getPressedKeys:()=>Array.from(o),isKeyPressed:s=>o.has(n(s))}};var X={fov:75,aspectRatio:window.innerWidth/window.innerHeight,near:.1,far:1e3},Y="game-engine",Z={SENSITIVITY:{sensitivityPitch:.001}};var Q=()=>{let{sensitivityPitch:n}=Z.SENSITIVITY,e={rotation:{pitch:0,yaw:0}},t=l=>{e.rotation.pitch+=l.movementY,e.rotation.yaw+=l.movementX;};return {onMount:()=>{document.addEventListener("mousemove",t);},onUnmount:()=>{document.removeEventListener("mousemove",t);},getRotation:()=>{let l=e.rotation.yaw,s=e.rotation.pitch;return e.rotation.pitch=0,e.rotation.yaw=0,{yaw:-3e-3*l,pitch:n*s}}}};var w=null,ee=()=>({onInit:()=>{w||(w={mouse:Q(),keyboard:W()},w.mouse.onMount(),w.keyboard.onMount());},getController:t=>w?w[t]:null,onUnmount:()=>{w&&(w.mouse.onUnmount(),w.keyboard.onUnmount());}});var te=()=>{let o=new Map;return {get:i=>o.get(i),set:(i,l)=>{o.set(i,l);},clear:()=>{o.clear();},delete:i=>{o.delete(i);},keys:()=>o.keys()}};var at=o=>te(),U=()=>{let o=at();return {store:(l,s)=>{o.set(l,s);},retrieve:l=>o.get(l),clear:()=>{o.clear();},delete:l=>{o.delete(l);},has:l=>!o.get(l),size:()=>o.keys.length}};var oe=()=>{let o={},n=["model","json"],e=i=>{switch(i){case "model":o[i]=U();break;case "json":o[i]=U();break}};return {inflate:()=>{n.forEach(i=>{e(i);});},clear:()=>{Object.values(o).forEach(i=>{i.clear();});},getStorage:i=>(o[i]||e(i),o[i])}};function M(o,...n){return ()=>o(...n)}function D(o){let n=[];for(let e of o)Array.isArray(e)?n.push(...D(e)):n.push(e);return n}var ne=document.createElement("template");ne.innerHTML=`
    <link rel="stylesheet" href="/style/background.css">
    <div class="background">
       <section class="summary">
          <h2 class="summary--title">Title</h2>
          <p class="summary--description">Description</p>
       </section>

       <section class="education">
          <h2 class="education--title">\u{1F393} Education</h2>
          <article class="education--item">
            <h3 class="education--course">Course</h3>
            <h4 class="education--institute">Institute Name</h4>
            <p class="education--description">Description</p>
          </article>
       </section>

       <section class="skills">
        <h2 class="skills-title">\u{1F6E0} Skills</h2>

        <ul class="skills--list">
            <li class="skill--category">
                <h3 class="skill--category--title">Title</h3>
                <ul class="skill--tags">
                  <li class="skill--item">Skill 1</li>
                  <li class="skill--item">Skill 2</li>
                  <li class="skill--item">Skill 3</li>
                  <li class="skill--item">Skill 4</li>
                  <li class="skill--item">Skill 5</li>
                  <li class="skill--item">Skill 6</li>

                </ul>
            </li>
        </ul>
       </section>
    </div>
`;var k=class extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"});let n=ne.content.cloneNode(true);this.root.appendChild(n),this.components={summary:{root:this.root.querySelector(".summary"),title:this.root.querySelector(".summary--title"),description:this.root.querySelector(".summary--description")},education:{course:this.root.querySelector(".education--course"),institution:this.root.querySelector(".education--institute"),description:this.root.querySelector(".education--description")},skillsRoot:this.root.querySelector(".skills--list")};}connectedCallback(){}disconnectedCallback(){}set Summary(n){console.log("update summary");let e=this.components.summary;e.title&&(e.title.textContent=n.title,e.description&&(e.description.textContent=n.description));}set Education(n){console.log("update education");let e=this.components.education;e.course&&(e.course.textContent=n.course,e.institution&&(e.institution.textContent=n.institute,e.description&&(e.description.textContent=n.description)));}addSkill(n){console.log("update skills");let e=document.createElement("li");e.classList.add("skill--category");let t=document.createElement("h3");t.classList.add("skill--category--title"),t.textContent=n.title,e.appendChild(t);let r=document.createElement("ul");return r.classList.add("skill--tags"),e.appendChild(r),n.tags.forEach(a=>{let i=document.createElement("li");i.classList.add("skill--item"),i.textContent=a,r.appendChild(i);}),e}set Skills(n){let e=document.createDocumentFragment();n.forEach(t=>{let r=this.addSkill(t);e.appendChild(r);}),this.components.skillsRoot.innerHTML="",this.components.skillsRoot.appendChild(e);}};var re=document.createElement("template");re.innerHTML=`
    <link rel="stylesheet" href="/style/experience.css">
    <div class="experience">
        <ul class="job-list">
          <li class="job-item">
            <div class="job-header">
              <h3 class="job-title">Title</h2>
              <h5 class="job-duration">Duration</h2>
            </div>
            <div class="job-details">
              <ul class="job-responsibilities">
                <li class="job-responsibility-item">Done task which improved some item</li>
              </ul>
            </div>
          </li>
        </ul>
    </div>
`;var P=class extends HTMLElement{constructor(){super();this.events={};this.root=this.attachShadow({mode:"open"});let e=re.content.cloneNode(true);this.root.appendChild(e),this.components={root:this.root.querySelector(".experience"),jobList:this.root.querySelector(".job-list")};}connectedCallback(){}disconnectedCallback(){}addEvent(e,t,r){let a=i=>{r.classList.toggle("hidden"),console.log("button is clicked ",t);};this.events[`button :${t}`]={button:e,callback:a},e.addEventListener("click",a),console.log("attaching event",t);}addJobExperience(e){let t=document.createElement("li");t.classList.add("job-item");let r=document.createElement("div");r.classList.add("job-header");let a=document.createElement("h3");a.classList.add("job-title"),a.textContent=e.title;let i=document.createElement("h5");i.classList.add("job-duration"),i.textContent=e.duration,r.appendChild(a),r.appendChild(i);let l=document.createElement("div");l.classList.add("job-details"),l.classList.add("hidden");let s=document.createElement("ul");s.classList.add("job-responsibilities");let u=document.createDocumentFragment();return e.responsibilities.forEach(d=>{let c=document.createElement("li");c.classList.add("job-responsibility-item"),c.textContent=d,u.appendChild(c);}),s.appendChild(u),l.appendChild(s),t.appendChild(r),t.appendChild(l),t}removeEvents(){console.log("remove all"),Object.entries(this.events).forEach(e=>{e[1].button.removeEventListener("click",e[1].callback);});}inflateCarousel(e){this.components.jobList&&(this.removeEvents(),this.components.jobList.innerHTML="",e.forEach((t,r)=>{this.components.jobList?.appendChild(this.addJobExperience({...t,index:r}));}));}set Experience(e){console.log("experience",e),this.inflateCarousel(e);}};var ae=document.createElement("template");ae.innerHTML=`
    <link rel="stylesheet" href="/style/frameworks.css">
    <div class="frameworks">
      <div class="framework__navigation">
        <button class="nav-btn nav--web">Web</button>
        <button class="nav-btn nav--mobile">Mobile</button>
        <button class="nav-btn nav--languages">Languages</button>
        <button class="nav-btn nav--cli">CLI</button>
      </div>

      <div class="framework__contents">
        <div class="web">
          <ul class="web__content"></ul>
        </div>
        <div class="mobile">
          <ul class="mobile__content"></ul>
        </div>
        <div class="languages">
          <ul class="languages__content"></ul>
        </div>
        <div class="cli">
          <ul class="cli__content"></ul>
        </div>
      </div>
    </div>
`;var R=class extends HTMLElement{constructor(){super();this.displayBus=null;this.webClick=e=>this.openPage(0);this.mobileClick=e=>this.openPage(1);this.languagesClick=e=>this.openPage(2);this.cliClick=e=>this.openPage(3);this.bindEvents=()=>{this.navigation.web&&this.navigation.web.addEventListener("click",this.webClick),this.navigation.mobile&&this.navigation.mobile.addEventListener("click",this.mobileClick),this.navigation.language&&this.navigation.language.addEventListener("click",this.languagesClick),this.navigation.cli&&this.navigation.cli.addEventListener("click",this.cliClick);};this.unbindEvents=()=>{this.navigation.web&&this.navigation.web.removeEventListener("click",this.webClick),this.navigation.mobile&&this.navigation.mobile.removeEventListener("click",this.mobileClick),this.navigation.language&&this.navigation.language.removeEventListener("click",this.languagesClick),this.navigation.cli&&this.navigation.cli.removeEventListener("click",this.cliClick);};this.root=this.attachShadow({mode:"open"});let e=ae.content.cloneNode(true);this.root.appendChild(e),this.components={framework:this.root.querySelector(".frameworks"),web:this.root.querySelector(".web__content"),mobile:this.root.querySelector(".mobile__content"),languages:this.root.querySelector(".languages__content"),cli:this.root.querySelector(".cli__content")},this.navigation={web:this.root.querySelector(".nav--web"),mobile:this.root.querySelector(".nav--mobile"),language:this.root.querySelector(".nav--languages"),cli:this.root.querySelector(".nav--cli")};}connectedCallback(){this.bindEvents();}disconnectedCallback(){this.unbindEvents();}openPage(e){let t=this.root.querySelector(".web"),r=this.root.querySelector(".mobile"),a=this.root.querySelector(".languages"),i=this.root.querySelector(".cli");t?.classList.toggle("active",false),r?.classList.toggle("active",false),a?.classList.toggle("active",false),i?.classList.toggle("active",false),e===0?t?.classList.toggle("active",true):e==1?r?.classList.toggle("active",true):e==2?a?.classList.toggle("active",true):e==3&&i?.classList.toggle("active",true);}addIcon(e,t,r){let a=document.createElement("li"),i=document.createElement("img");return i.setAttribute("src",r),i.setAttribute("alt",e),i.classList.add("framework_logo"),a.appendChild(i),a}inflate(e,t){switch(t){case "web":let r=document.createDocumentFragment();e.forEach(s=>{r.appendChild(this.addIcon(s.name,[],s.link));}),this.components.web?.appendChild(r);break;case "mobile":let a=document.createDocumentFragment();e.forEach(s=>{a.appendChild(this.addIcon(s.name,[],s.link));}),this.components.mobile?.appendChild(a);break;case "languages":let i=document.createDocumentFragment();e.forEach(s=>{i.appendChild(this.addIcon(s.name,[],s.link));}),this.components.languages?.appendChild(i);break;case "command-line":let l=document.createDocumentFragment();e.forEach(s=>{l.appendChild(this.addIcon(s.name,[],s.link));}),this.components.cli?.appendChild(l);break;default:console.warn("The types doesnt match for frameworks");}}set FrameworkData(e){this.inflate(e.web,"web"),this.inflate(e.mobile,"mobile"),this.inflate(e.languages,"languages"),this.inflate(e.cli,"command-line");}};var ie=document.createElement("template");ie.innerHTML=`
    <link rel="stylesheet" href="/style/resume.css">
    <div class="resume">
      <div class="resume__layout">
        <div class="resume__pdf">
          <iframe 
            src="/assets/pdf/my_resume.pdf"
            title="Resume PDF Viewer"
            loading="lazy"
          >
            Your browser does not support embedded PDFs. 
            <a href="/assets/pdf/my_resume.pdf" download>Download the resume</a>.
          </iframe>
        </div>
        <a 
          class="download" 
          href="/assets/pdf/my_resume.pdf" 
          download 
          title="Download a copy of the resume"
        >
          \u{1F4C4} Download Resume
        </a>
      </div> 
    </div>
`;var I=class extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"});let n=ie.content.cloneNode(true);this.root.appendChild(n);}connectedCallback(){}disconnectedCallback(){}};var se=document.createElement("template");se.innerHTML=`
    <link rel="stylesheet" href="/style/about.css">
    <style>
    .hidden {
      opacity: 0;
      pointer-events: none;
      transform: translateY(-50%) scale(0.95);
      transition: all 0.3s ease;
    }
    </style>
    <div class="about hidden">
        <div class="tab">
          <h3 class="tab--name">Background</h3>  
        </div>
        <div class="carousel">
          <div class="carousel-container">
            <ul class="carousel-track">
                <li class="slide" data-active><slot name="background">Background</slot></li>
                <li class="slide"><slot name="experience">Experience</slot></li>
                <li class="slide"><slot name="resume">Resume</slot></li>
                <li class="slide"><slot name="frameworks">Frameworks</slot></li>
            </ul>
          </div>
          <button class="carousel__button prev">&#8678;</button>
          <button class="carousel__button next">&#8680;</button>
          <div class="carousel_nav">
                <button class="carousel_indicator" data-active-button></button>
                <button class="carousel_indicator"></button>
                <button class="carousel_indicator"></button>
                <button class="carousel_indicator"></button>
          </div>
        </div>
    </div>
`;var it=["\u{1F468}\u200D\u{1F393} Background","\u{1F468}\u200D\u{1F4BB} Experience","\u{1F4C4} Resume","\u{1F5A5}\uFE0F Frameworks"],O=class extends HTMLElement{constructor(){super();this.state={currentIndex:0};this.displayBus=null;this.carouselItem=null;this.prevClick=e=>this.swapSlides(-1);this.nextClick=e=>this.swapSlides(1);this.navButtonClicks=[];this.defineElements=()=>{customElements.get("background-page")||customElements.define("background-page",k),customElements.get("experience-page")||customElements.define("experience-page",P),customElements.get("resume-page")||customElements.define("resume-page",I),customElements.get("frameworks-page")||customElements.define("frameworks-page",R);};this.querySlottedElements=()=>{let e=this.findElement("background",k),t=this.findElement("experience",P),r=this.findElement("resume",I),a=this.findElement("frameworks",R);this.carouselItem={background:e,experience:t,resume:r,frameworks:a};};this.onShow=()=>{this.components.about?.classList.toggle("hidden",false);};this.onHide=()=>{this.components.about?.classList.toggle("hidden",true);};this.bindEvents=()=>{this.components.prev?.addEventListener("click",this.prevClick),this.components.next?.addEventListener("click",this.nextClick),this.components.navButtons.forEach((e,t)=>{e.addEventListener("click",this.navButtonClicks[t]);});};this.unbindEvents=()=>{this.components.prev?.removeEventListener("click",this.prevClick),this.components.next?.removeEventListener("click",this.nextClick),this.components.navButtons.forEach((e,t)=>{e.removeEventListener("click",this.navButtonClicks[t]);});};this.root=this.attachShadow({mode:"open"});let e=se.content.cloneNode(true);this.root.appendChild(e);let t=Array.from(this.root.querySelector(".carousel_nav")?.children??[]);this.components={about:this.root.querySelector(".about"),tabName:this.root.querySelector(".tab--name"),carousel:this.root.querySelector(".carousel"),next:this.root.querySelector(".next"),prev:this.root.querySelector(".prev"),track:this.root.querySelector(".carousel-track"),navButtons:t},this.components.navButtons.forEach((r,a)=>{this.navButtonClicks.push(i=>this.swapSlides(a-this.state.currentIndex));}),this.defineElements(),this.querySlottedElements(),this.components.about?.classList.toggle("hidden");}findElement(e,t){let r=`slot[name="${e}"]`;return (this.root.querySelector(r).assignedElements?.()||[]).find(s=>s instanceof t)}set eventBusManager(e){this.displayBus=e.displayBus,this.displayBus.on("about:show",this.onShow),this.displayBus.on("about:hide",this.onHide);}set updateData(e){e.isError?this.root.innerHTML=`
        <p>${e.message}</p>
      `:this.inflateCarousel(e.records);}connectedCallback(){this.bindEvents();}disconnectedCallback(){this.unbindEvents(),this.displayBus?.off("about:show",this.onShow),this.displayBus?.off("about:hide",this.onHide);}swapSlides(e){if(!this.components.track)return;let t=this.state.currentIndex,r=this.components.track.children.length;this.state.currentIndex+=e,this.state.currentIndex<0&&(this.state.currentIndex=r-1),this.state.currentIndex>=r&&(this.state.currentIndex=0);let a=this.components.track.children[t];this.components.tabName&&(this.components.tabName.textContent=it[this.state.currentIndex]),this.components.track.children[this.state.currentIndex].dataset.active="true",delete a.dataset.active,this.components.navButtons[this.state.currentIndex].dataset.activeButton="true",delete this.components.navButtons[t].dataset.activeButton;}setBackground(e){if(!this.carouselItem?.background)return;this.carouselItem.background.Summary={title:e.summary.title??"Title-Placeholder",description:e.summary.description??"Description"};let t=e.education;this.carouselItem.background.Education={course:t.course,institute:t.institute,description:t.description};let r=e.skills;this.carouselItem.background.Skills=r.map(a=>({title:a.title,tags:a.tags}));}setExperience(e){this.carouselItem?.experience&&(this.carouselItem.experience.Experience=e.map(t=>({title:t.title,duration:t.duration,responsibilities:t.responsibilities})));}setResume(e){this.carouselItem?.resume;}setFrameworks(e){this.carouselItem?.frameworks&&(this.carouselItem.frameworks.FrameworkData=e);}inflateCarousel(e){this.setBackground(e.personal.data),this.setExperience(e.experience.data),this.setResume(e.resume.data),this.setFrameworks(e.frameworks.data);}};var le=document.createElement("template");le.innerHTML=`
  <link rel="stylesheet" href="/style/card.css" />
  <div class="card">
    <div class="card-content">
     <div class="card-header">
        <div class="card-image">
          <img src="" alt="" loading="lazy"/>
        </div>
        <div class="title-group">
          <h3></h3>
          <small class="sub-heading"></small>
        </div>
      </div>  
     
      <p class="description"></p>
      <div class="tags"></div>
      <a class="github-link" href="" >
        <img src="/assets/images/github-brands-solid.svg" alt="Github" loading="lazy"/>
        Github
      </a>
    </div>
  </div>
`;var st=["title","image","description","tags","linkUrl"],_=class extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"});let n=le.content.cloneNode(true);this.root.appendChild(n),this.components={logo:this.root.querySelector("img"),title:this.root.querySelector("h3"),description:this.root.querySelector("p"),tagRoot:this.root.querySelector(".tags"),link:this.root.querySelector(".github-link")};}static get observedAttributes(){return st}attributeChangedCallback(n,e,t){e!==t&&this.render(n);}setData(n){this.setAttribute("title",n.title),this.setAttribute("image",n.imageUrl),this.setAttribute("description",n.description),this.setAttribute("tags",n.tags??""),this.setAttribute("linkUrl",n.linkUrl);}render(n){switch(n){case "title":let e=this.getAttribute("title")||"";this.components.title&&(this.components.title.textContent=e);break;case "description":let t=this.getAttribute("description")||"";this.components.description&&(this.components.description.textContent=t);break;case "image":let r=this.getAttribute("image")||"",a=this.getAttribute("title")||"";this.components.logo&&(this.components.logo.setAttribute("src",r),this.components.logo.setAttribute("alt",a));break;case "tags":let i=(this.getAttribute("tags")||"").split(",");if(this.components.tagRoot){let s=i.map(u=>{let d=document.createElement("span");return d.textContent=u,d});this.components.tagRoot.replaceChildren(...s);}break;case "linkUrl":let l=this.getAttribute("linkUrl")||"";this.components.link&&this.components.link.setAttribute("href",l);break}}connectedCallback(){}disconnectedCallback(){}};var ce=document.createElement("template");ce.innerHTML=`
    <link rel="stylesheet" href="/style/gallery.css">
    <style>
      .hidden {
        transform: translateX(-50%) scale(0.95);
        opacity: 0;
        pointer-events: none;
      }
    </style>
    <div class="gallery hidden" id="gallery">
    </div>
`;var H=class extends HTMLElement{constructor(){super();this.onShow=e=>this.showComponent(e);this.onHide=e=>this.hideComponent(e);this.root=this.attachShadow({mode:"open"});let e=ce.content.cloneNode(true);this.root.appendChild(e),this.gallery=this.root.getElementById("gallery");}set eventBusManager(e){this.viewEventBus=e.viewBus,console.log("event bus attached to project gallery");}showComponent(e){console.log("gallery shown "),this.gallery?.classList.remove("hidden");}hideComponent(e){console.log("gallery hidden"),this.gallery?.classList.add("hidden");}inflateData(e){if(!this.gallery)return;let t=document.createDocumentFragment();e.forEach(r=>{let a=document.createElement("project-card");a.setData(r),t.appendChild(a);}),this.gallery.appendChild(t),this.viewEventBus&&(this.viewEventBus.on("project-screen:show",this.onShow),this.viewEventBus.on("project-screen:hide",this.onHide));}set updateData(e){e.isError?this.root.innerHTML=`
          <p>${e.message}</p>
        `:this.inflateData(e.list);}connectedCallback(){}disconnectedCallback(){this.viewEventBus&&(this.viewEventBus.off("project-screen:show",this.onShow),this.viewEventBus.off("project-screen:hide",this.onHide));}};var lt=()=>{let o=new Map;return {register:(r,a)=>{if(o.has(r))throw new Error(`Error : Redefining the service [${r}]`);o.set(r,a);},get:r=>{let a=o.get(r);if(!a)throw new Error(`Error : Trying to obtain value of an unregistered service ${r}`);return a},has:r=>o.has(r)}},F,y=()=>(F||(F=lt()),F);var de=document.createElement("template");de.innerHTML=`
    <link rel="stylesheet" href="/style/loading_modal.css"/>
   
    <div class="overlay hidden" id="overlay">
      <div class="loading-logo"></div>
      <div id="loading-text">Loading...</div>
    </div>
`;var K=class extends HTMLElement{constructor(){super();this.handleLoading=()=>{};this.root=this.attachShadow({mode:"open"});let e=de.content.cloneNode(true);this.root.appendChild(e),this.progress=0,this.tags={overlay:this.root.getElementById("overlay")},this.logger=y().get("Logger"),this.logger.onLoad({origin:"Loading Modal"});}set eventBusManager(e){this.loadingEventBus=e.loadingBus,this.handleLoading();}connectedCallback(){}disconnectedCallback(){}};var ue=document.createElement("template");ue.innerHTML=`
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  <link rel="stylesheet" href="/style/navbar.css">
  <nav class="navbar" id="main-nav">
      <div class="logo">Logo</div>
      <button class="toggle-btn" aria-expanded="false" aria-controls="main-nav">&#9776</button>
      <ul class="nav-links" aria-expanded="false">
          <li>
            <a href="" id="home" aria-label="Home" class="active"> 
              <i class="fas fa-home"></i>
              <span class="desktop">Home</span>
            </a>
          </li>
          <li>
            <a href="" id="about" aria-label="About">
              <i class="fas fa-user"></i> 
              <span>About</span>
            </a>
          </li>
          <li>
            <a href="" id="projects" aria-label="Projects">
              <i class="fas fa-folder-open"></i>
              <span>Projects</span>
            </a>
          </li>
          <li>
            <a href="" id="contact" aria-label="Contact">
              <i class="fas fa-envelope"></i>
              <span>Contact</span>
            </a>
          </li>
      </ul>
  </nav>
`;var N=class extends HTMLElement{constructor(){super();this.displayEventBus=null;this.busHandlers=null;this.sections=["projects","about","contact","home"];this.toggleHamburgerMenu=()=>{if(console.log(this.components.navLinks),!this.components.navLinks)return;let t=!(this.components.navLinks.getAttribute("aria-expanded")==="true");this.components.navLinks.setAttribute("aria-expanded",String(t)),this.components?.toggleBtn?.setAttribute("aria-expanded",String(t));};this.setActiveTab=e=>{this.links.forEach(t=>{t?.classList.remove("active");}),this.components[e]?.classList.add("active"),this.state.activeTab=e;};this.toggleSections=(e,t)=>{if(this.state.activeTab==t)return;e.preventDefault();let r={elementId:t,type:`${this.state.activeTab}:hide`};this.displayEventBus?.emit(r),this.setActiveTab(t);let a={elementId:t,type:`${t}:show`};console.log(`nvbar emits  ${a.type}`),this.displayEventBus?.emit(a);};this.onToggleClick=e=>this.toggleHamburgerMenu();this.onProjectClick=e=>this.toggleSections(e,"projects");this.onAboutClick=e=>this.toggleSections(e,"about");this.onHomeClick=e=>this.toggleSections(e,"home");this.onContactClick=e=>this.toggleSections(e,"contact");this.setupBusListeners=()=>{this.displayEventBus&&this.sections.forEach(e=>{let t=a=>{this.logger.onMount({origin:`[${e}]-component`});},r=a=>{this.logger.onUnmount({origin:`[${e}]-component`});};this.displayEventBus?.on(`${e}:show`,t),this.displayEventBus?.on(`${e}:hide`,r),this.busHandlers&&(this.busHandlers[`${e}:show`]=t,this.busHandlers[`${e}:hide`]=r);});};this.disposeBusListeners=()=>{this.displayEventBus&&this.sections.forEach(e=>{this.busHandlers&&(this.displayEventBus?.off(`${e}:show`,this.busHandlers[`${e}:show`]),this.displayEventBus?.off(`${e}:hide`,this.busHandlers[`${e}:hide`]));});};this.root=this.attachShadow({mode:"open"});let e=ue.content.cloneNode(true);this.root.appendChild(e),this.state={activeTab:"home"},this.components={about:null,navLinks:null,projects:null,contact:null,home:null,toggleBtn:null},this.queryElements(),this.links=[this.components.home,this.components.about,this.components.projects,this.components.contact],this.logger=y().get("Logger"),this.logger.onLoad({origin:"Navbar"});}static get observedAttributes(){return []}connectedCallback(){this.bindEvents(),this.setupBusListeners();}disconnectedCallback(){this.unBindEvents(),this.disposeBusListeners();}queryElements(){this.components.toggleBtn=this.root.querySelector(".toggle-btn"),this.components.navLinks=this.root.querySelector(".nav-links"),this.components.navLinks&&(this.components.projects=this.components.navLinks.querySelector("#projects"),this.components.about=this.components.navLinks.querySelector("#about"),this.components.contact=this.components.navLinks.querySelector("#contact"),this.components.home=this.components.navLinks.querySelector("#home"));}bindEvents(){this.components.toggleBtn?.addEventListener("click",this.onToggleClick),this.components.projects?.addEventListener("click",this.onProjectClick),this.components.about?.addEventListener("click",this.onAboutClick),this.components.home?.addEventListener("click",this.onHomeClick),this.components.contact?.addEventListener("click",this.onContactClick);}unBindEvents(){this.components.toggleBtn?.removeEventListener("click",this.onToggleClick),this.components.projects?.removeEventListener("click",this.onProjectClick),this.components.about?.removeEventListener("click",this.onAboutClick),this.components.home?.removeEventListener("click",this.onHomeClick),this.components.contact?.removeEventListener("click",this.onContactClick);}set eventBusManager(e){this.displayEventBus=e.displayBus;}};var me=document.createElement("template");me.innerHTML=`
    <link rel="stylesheet" href="/style/scene_inspector.css">
    <div class="inspector-wrapper">

      <div class="resizer"></div>
    
      <div class="scene-inspector hidden">
        <div class="inspector-header">
          <span class="title">Scene Inspector</span>
          <button class="close-btn"> \u2715 </button>
        </div>

        <div class="inspector-content">
          <ul class="tree-view">

          </ul>
        </div>
      </div>

      
    </div>
`;var G=class extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"});let n=me.content.cloneNode(true);this.root.appendChild(n),this.state={isMenuHidden:true,isResizing:false},this.element=this.root.querySelector(".scene-inspector"),this.treeView={Objects:[],Materials:[]},this.handleResize();}set eventBusManager(n){this.eventBus=n.debugBus,this.eventBus?.on("debug:inspector",e=>{this.handleShowHideEvent(e);});}handleShowHideEvent(n){this.state.isMenuHidden=!this.state.isMenuHidden,this.state.isMenuHidden?this.element.classList.add("hidden"):(this.element.classList.remove("hidden"),n.scene!=null&&n.scene!==void 0&&this.renderTree(n.scene));}handleResize(){let n=this.root.querySelector(".resizer"),e=this.root.querySelector(".scene-inspector");n.addEventListener("mousedown",t=>{this.state.isResizing=true,document.body.style.cursor="ew-resize",t.preventDefault();}),window.addEventListener("mousemove",t=>{if(!this.state.isResizing)return;let r=window.innerWidth-t.clientX;e.style.width=`${Math.min(Math.max(r,200),600)}px`;}),window.addEventListener("mouseup",t=>{this.state.isResizing&&(this.state.isResizing=false,document.body.style.cursor="");});}toggleCloseButton(){this.state.isMenuHidden=true,this.element.classList.add("hidden");}collectSceneData(n){let e=[],t=new Map,r=a=>{let i={id:a.uuid,label:a.name==""?a.type:a.name,type:a.type,nodes:[]};return a.children.forEach(l=>{i.nodes.push(r(l));}),"material"in a&&a.material&&(Array.isArray(a.material)?a.material:[a.material]).forEach(s=>{t.has(s.uuid)||t.set(s.uuid,{id:s.uuid,label:s.name==""?s.type:s.name,type:"material",nodes:[]});}),i};return n.children.forEach(a=>{e.push(r(a));}),{Objects:e,Materials:Array.from(t.values())}}renderTree(n){this.treeView=this.collectSceneData(n);let e=this.root.querySelector(".tree-view");e.innerHTML="",this.addCategory("Objects",e,this.treeView.Objects),this.addCategory("Materials",e,this.treeView.Materials);}addCategory(n,e,t){let r=document.createElement("li");r.classList.add("category","collapsed");let a=document.createElement("div");a.classList.add("category-toggle"),a.textContent=`\u2B9E ${n}`,a.addEventListener("click",l=>{r.classList.toggle("collapsed");let s=r.classList.contains("collapsed");a.textContent=s?`\u2B9E ${n}`:`\u25BC ${n}`;});let i=document.createElement("ul");i.classList.add("category-content"),t.forEach(l=>{i.appendChild(this.renderTreeNode(l));}),r.appendChild(a),r.appendChild(i),e.appendChild(r);}renderTreeNode(n){let e=document.createElement("li");e.classList.add("tree-node");let t=document.createElement("div");if(t.classList.add("node-label"),t.textContent=`${n.label} (${n.type})`,e.appendChild(t),n.nodes.length>0){e.classList.add("collapsed");let r=document.createElement("ul");n.nodes.forEach(a=>{r.appendChild(this.renderTreeNode(a));}),t.addEventListener("click",()=>{e.classList.toggle("collapsed");}),e.appendChild(r);}return e}connectedCallback(){this.root.querySelector(".close-btn").addEventListener("click",()=>{this.toggleCloseButton();});}disconnectedCallback(){}};var ct=async o=>await(await fetch(o)).json(),dt=async()=>{let o=document.querySelector("about-page");try{let n=await ct("/public/data/about.json");o.updateData={isError:!1,records:n};}catch(n){o.updateData={isError:true,message:`Error getting data ${n}`},console.error(`Error getting data ${n}`);}},ut=async()=>{let o=document.querySelector("project-gallery");try{let e=await(await fetch("/public/data/projects.json")).json();o.updateData={isError:!1,list:e.projects};}catch(n){o.updateData={isError:true,message:`Error getting data ${n}`},console.error(`Error getting data ${n}`);}},pe=()=>{let o={navbarDefined:false,loadingModalDefined:false,sceneInspectorDefined:false,projectGalleryDefined:false,aboutPageDefined:false},n=y(),[e,t,r]=[n.get("LifecycleScheduler"),n.get("Logger"),n.get("EventBusManager")];return {onInit:()=>{o.navbarDefined||(customElements.define("nav-bar",N),o.navbarDefined=true),o.loadingModalDefined||(customElements.define("loading-modal",K),o.loadingModalDefined=true),o.sceneInspectorDefined||(customElements.define("scene-inspector",G),o.sceneInspectorDefined=true),r.displayBus.once("projects:show",()=>{o.projectGalleryDefined||(t.onMount({origin:"Projects-Page"}),r.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),customElements.define("project-gallery",H),customElements.define("project-card",_),e.schedule(M(()=>{try{let c=document.querySelector("project-gallery");c.eventBusManager=r;}catch(c){console.error(c);}})),e.schedule(M(async()=>{try{console.log("loading data"),await ut(),r.loadingBus.emit({type:"load:complete"});}catch(c){console.log(`Error while loading projects data ${c}`);}})),o.projectGalleryDefined=true);}),r.displayBus.once("about:show",()=>{o.aboutPageDefined||(t.onMount({origin:"About-Page"}),r.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),customElements.define("about-page",O),e.schedule(M(async()=>{await dt(),r.loadingBus.emit({type:"load:complete"});})),e.schedule(M(()=>{try{let c=document.querySelector("about-page");c.eventBusManager=r;}catch(c){console.error(c);}})),o.aboutPageDefined=true);});},onLoad:()=>{t.onLoad({origin:"DOMManager"});try{let c=document.querySelector("loading-modal");c.eventBusManager=r;}catch(c){console.error(`Missing loading modal element :${c}`);}try{let c=document.querySelector("nav-bar");c.eventBusManager=r;}catch(c){console.error(`Missing navbar element : ${c}`);}try{let c=document.querySelector("scene-inspector");c.eventBusManager=r;}catch(c){console.error(c);}},onMount:()=>{t.onMount({origin:"DOMManager"});},onUpdate:()=>{t.onUpdate(0,{origin:"DOMManager"});},onUnmount:()=>{["loading-modal","nav-bar","scene-inspector"].forEach(m=>{let f=document.querySelector(m);f?.parentElement?f.parentElement.removeChild(f):console.warn(`Could not unmount ${m} either already removed or not found`);}),t.onUnmount({origin:"DOMManger"});},onDestroy:()=>{t.onDestroy({origin:"DOMManager"});}}};var A={PATH_TO_MODELS:"/assets/Models/",PATH_TO_HDR:"/assets/HDR/"},ge={id:"player",path:A.PATH_TO_MODELS+"player.glb",type:"glb"},he={meshes:[{id:"navigation",path:A.PATH_TO_MODELS+"room.glb",type:"glb"}],hdr:{id:"environment_hdr",path:A.PATH_TO_HDR+"environment.hdr",type:"hdr"}},ve={meshes:[{id:"about",path:A.PATH_TO_MODELS+"about.glb",type:"glb"}]},fe={meshes:[{id:"projects",path:A.PATH_TO_MODELS+"projects.glb",type:"glb"}]};var be={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"navigation"}},ye={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"about"}},Me={player:{id:"RootNode",storageId:"player"},ground:{id:"ground",storageId:"projects"}};var Ee=({loadingManager:o,scene:n,storageManager:e})=>{let t=new FBXLoader(o),r=async i=>{try{let l=await t.loadAsync(i.path);e.getStorage("model").store(i.id,{animations:l.animations,groups:l}),n.add(l);}catch(l){throw new Error(`Error while loading fbx file : ${l}`)}};return {load:async i=>{let l=[];i.forEach(s=>{l.push(r(s));}),await Promise.allSettled(l);}}};var Se=({scene:o,loadingManager:n,storageManager:e})=>{let t=new GLTFLoader(n),r=new DRACOLoader;r.setDecoderPath("/public/draco/"),t.setDRACOLoader(r);let a=async l=>{try{let s=await t.loadAsync(l.path);e.getStorage("model").store(l.id,{animations:s.animations,groups:s.scene}),o.add(s.scene);}catch(s){throw new Error(`Errr occuerd while loading a glb file : ${s}`)}};return {load:async l=>{let s=[];l.forEach(u=>{s.push(a(u));}),await Promise.allSettled(s);}}};var Le=({loadingManager:o,renderer:n,scene:e})=>{let t=new PMREMGenerator(n),r=new RGBELoader(o),a=async s=>new Promise((u,d)=>{console.log("path",s.path),r.load(s.path,(c,m)=>{let f=t.fromEquirectangular(c).texture;c.dispose(),e.environment=f,d();},void 0,c=>{u();});}),i=async s=>{let u=[];s.forEach(async d=>{u.push(a(d));}),await Promise.allSettled(u);};return {load:i}};var we=({scene:o,renderer:n,loaderEventBus:e,stateManager:t,storageManager:r})=>{let a=new LoadingManager,i=false,[l,s,u]=[Se({scene:o,loadingManager:a,storageManager:r}),Ee({scene:o,loadingManager:a,storageManager:r}),Le({scene:o,loadingManager:a,renderer:n})],d={glb:[],fbx:[],hdr:[]},c=()=>{a.onStart=(b,h,v)=>{e.emit({type:"load:start",url:b,loaded:h,total:v}),t.loading.setState({loading:{active:true,progress:0}});},a.onProgress=(b,h,v)=>{e.emit({type:"load:progress",url:b,loaded:h,total:v}),t.loading.setState({loading:{active:true,progress:h/v}});},a.onLoad=()=>{e.emit({type:"load:complete"});},a.onError=b=>{e.emit({type:"load:error",url:b});},i=true;},m=b=>{switch(b.type){case "glb":d.glb.push(b);break;case "fbx":d.fbx.push(b);break;case "hdr":d.hdr.push(b);break;}},f=b=>{b.forEach(h=>{m(h);});};return {configure:()=>{c();},load:async b=>{if(!i)throw new Error("Error: Trying to load from loader before configuring it");let h=[];return f(b),h.push(l.load(d.glb)),h.push(s.load(d.fbx)),h.push(u.load(d.hdr)),await Promise.allSettled(h),d.fbx=[],d.glb=[],d.hdr=[],{success:[],error:[]}},dispose:()=>{}}};var Te=o=>{let{camera:n}=o,t=new Vector3(0,1,2);return {mount:()=>{},activate:()=>{n.position.set(t.x,1,t.z),n.rotation.set(0,0,0,"XYZ");},deactivate:()=>{},unmount:()=>{}}};var xe=({logger:o,reference:n,storage:e})=>{let t=null;return {mount:()=>{if(t=e.getStorage("model").retrieve(n.storageId)?.groups.getObjectByName(n.id),!t){console.error(`Cant get ground mesh from the id : ${n.id}`);return}t.material=t.material.clone(),t.receiveShadow=true,t.material.needsUpdate=true,t.material.opacity=.15,t.material.transparent=true,o.onMount({origin:"about-ground"});},actiavte:()=>{},deactivate:()=>{},unmount:()=>{}}};var Ce=({renderer:o,scene:n})=>{let e,t;return {mount:()=>{e=new DirectionalLight(16777215,5),e.castShadow=true,e.position.set(0,2,0),e.target.position.set(0,1,0),e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.1,e.shadow.camera.far=50,e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10,t=new AmbientLight(16777215),o.shadowMap.enabled=true,o.shadowMap.type=PCFShadowMap;},activate:()=>{e&&n.add(e),t&&n.add(t);},deactivate:()=>{e&&n.remove(e),t&&n.remove(t);},unmount:()=>{}}};var ke=({logger:o,reference:n,scene:e,storage:t})=>{let r,a,i=c=>{c.traverse(m=>{m.castShadow=true;});};return {mount:()=>{try{o.onMount({origin:"about-room-player"});let c=e.getObjectByName(n.id);if(!c)throw new Error(`player doesn't exist for the id ${n.id}`);r={playerRoot:c},a={mixer:new AnimationMixer(c)};}catch(c){console.error(`Player mesh cant be obtained :${c}`);}},activate:()=>{r.playerRoot&&(r.playerRoot.rotation.set(0,-Math.PI/4,0,"XYZ"),r.playerRoot.castShadow=true,i(r.playerRoot),r.playerRoot.position.set(1.5,0,0));},deactiavte:()=>{},unmount:()=>{r.playerRoot&&r.playerRoot.position.set(1.5,0,0);}}};var Pe=({ground:o,player:n})=>{let e=y(),[t,r,a]=[e.get("GlobalStorageManager"),e.get("Logger"),e.get("ThreeJSContextManager")],{scene:i,camera:l,orbit:s,renderer:u}={scene:a.get("scene"),camera:a.get("camera"),orbit:a.get("orbit"),renderer:a.get("renderer")},d={camera:Te({camera:l}),player:ke({logger:r,reference:n,scene:i,storage:t}),ground:xe({logger:r,reference:o,storage:t}),lighting:Ce({renderer:u,scene:i})},c=null;return {mount:()=>{r.onMount({origin:"about-room"}),d.ground.mount(),d.player.mount(),d.lighting.mount(),c=t.getStorage("model").retrieve(o.storageId)?.groups??null;},setActive:()=>{c&&(c.visible=true),s.enabled=false,d.camera.activate(),d.lighting.activate(),d.player.activate();},update:b=>{},setDeactive:()=>{c&&(c.visible=false),d.lighting.deactivate();},unmount:()=>{d.player.unmount();},isLoaded:false}};var x={DISTANCE:3,HEIGHT_OFFSET:2,PITCH_MIN:0,PITH_MAX:Math.PI/2,SMOOTHING:.1},Ie=new Vector3(0,0,0),T=new Vector3(0,0,0),V=new Vector3(0,0,0);function wt(o,n){return {yaw:MathUtils.euclideanModulo(o,Math.PI*2),pitch:MathUtils.clamp(n,x.PITCH_MIN,x.PITH_MAX)}}function Tt(o){return T.set(0,0,0),T.setFromSpherical(o),T.y+=x.HEIGHT_OFFSET,T}function xt(o,n,e){return o.lerp(n,e)}var Ae=({camera:o})=>{let e={mode:"thirdPerson",rotation:{pitch:Math.PI/2,yaw:0},spherical:new Spherical(x.DISTANCE,Math.PI/2,0)},t=m=>{e.mode=m;},r=()=>{},a=()=>{o.position.set(1,2,3);},i=m=>{e.rotation.yaw+=m.yaw,e.rotation.pitch+=m.pitch;let f=wt(e.rotation.yaw,e.rotation.pitch);e.rotation.yaw=f.yaw,e.rotation.pitch=f.pitch;},l=m=>{e.spherical.theta=e.rotation.yaw,e.spherical.phi=e.rotation.pitch,T.copy(Tt(e.spherical)),Ie.copy(m.playerPosition).add(T),o.position.copy(xt(o.position,Ie,x.SMOOTHING)),V.copy(m.playerPosition),V.y+=x.HEIGHT_OFFSET,o.lookAt(V);},s=m=>{o.position.copy(m),o.rotation.set(e.rotation.pitch,e.rotation.yaw,0);};return {setMode:t,update:m=>(i(m.rotationDelta),e.mode==="thirdPerson"?l(m):s(m.playerPosition),{rotation:o.rotation}),mount:r,activate:a,deactivate:()=>{},unmount:()=>{}}};var Be=`
    precision highp float;

    varying vec2 vUV;

    float line(vec2 uv,float lineWidth){

       
        float lineAA=fwidth(uv.x);
 
        float lineUV=1.0-abs(fract(uv.x)*2.0-1.0);

        return smoothstep(lineWidth+lineAA,lineWidth-lineAA,lineUV);
    }  

    float grid(vec2 uv,float lineWidth){

        vec2 uvDeriv=fwidth(uv);
        vec2 drawWidth=max(vec2(lineWidth),uvDeriv);
        vec2 lineAA=uvDeriv*1.5;
 
        vec2 gridUV=1.0-abs(fract(uv)*2.0-1.0);

        vec2 gridLines=smoothstep(drawWidth+lineAA,drawWidth-lineAA,gridUV);
        gridLines*=clamp(lineWidth/drawWidth,0.0,1.0);

        return mix(gridLines.x,1.0,gridLines.y);
    } 

    void main(){
        vec2 st=vUV*1500.0;
       
        gl_FragColor = vec4(vec3(grid(st,0.01)),1.0);
    }

`;var De=`
    precision highp float;

    

    varying vec2 vUV;
    varying vec4 vWorldPos; 

    void main(){
        vUV=uv;
        vWorldPos=modelViewMatrix*vec4(position,1.0);

        gl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);
    }

`;var Oe=o=>{let n=new ShaderMaterial({uniforms:{time:{value:1},cameraPos:{value:o.camera.position},fadeNear:{value:o.fadeNear},fadeFar:{value:o.fadeFar}},vertexShader:De,fragmentShader:Be});return {mat:n,update:t=>{n.uniforms.cameraPos.value=t;}}};var _e=({logger:o,references:n,storage:e,camera:t})=>{let r=null,a=null;return {mount:()=>{if(r=e.getStorage("model").retrieve(n.storageId)?.groups.getObjectByName(n.id)??null,!r){console.error(`Cant get ground mesh from the id : ${n.id} ${n.storageId}`);return}a=Oe({camera:t,fadeNear:.1,fadeFar:1}),r.material=a.mat,o.onMount({origin:"Navigation-Ground"});},update:()=>{a?.update(t.position);},activate:()=>{},deactivate:()=>{},unmount:()=>{}}};var He=({mixer:o,actions:n,crossFadeDuration:e=.3})=>{let t=null,a=null;return {play:(d,c=0)=>{if(t===d)return;let m=n[d];m&&(m.reset(),m.play(),a?.crossFadeTo(m,e,false),a=m,t=d);},getCurrentAnimation:()=>t,stop:()=>{},update:d=>{d!==void 0&&o.update(d);}}};var kt=o=>({enter:r=>{console.log("enter idle"),o.animationController.play(o.animationId);},execute:r=>{r.isMoving()&&(r.isShiftPressed()?r.changeState("Run"):r.changeState("Walk"));},exit:r=>{console.log("exit idle");}}),Pt=o=>({enter:r=>{console.log("enter walk"),o.animationController.play(o.animationId);},execute:r=>{r.isMoving()?r.isShiftPressed()&&r.changeState("Run"):r.changeState("Idle");},exit:r=>{console.log("exit walk");}}),Rt=o=>({enter:r=>{console.log("enter run"),o.animationController.play(o.animationId);},execute:r=>{r.isMoving()?r.isShiftPressed()||r.changeState("Walk"):r.changeState("Idle");},exit:r=>{console.log("exit run");}}),Ke=({inputs:o,animationController:n})=>{let {keyboard:t}={mouse:o.getController("mouse"),keyboard:o.getController("keyboard")},{idle:a,walk:i,run:l}={idle:kt({animationController:n,animationId:"Idle"}),walk:Pt({animationController:n,animationId:"Walk"}),run:Rt({animationController:n,animationId:"Run"})},s=a,u="Idle",d=h=>{s.execute(E),n.update(h);},c=()=>!!(t?.isKeyPressed("w")||t?.isKeyPressed("a")||t?.isKeyPressed("s")||t?.isKeyPressed("d")),m=()=>t?.isKeyPressed("shift")??false,f=h=>{switch(h){case "Idle":return a;case "Walk":return i;case "Run":return l;default:return a}},S=h=>{u!==h&&(u=h,s.exit(E),s=f(h),s.enter(E));},p=()=>{s.enter(E);},E={changeState:S,isMoving:c,isShiftPressed:m};return {mount:p,update:d,unmount:()=>{}}};var Ne={MOVEMENT_ACCELERATION:.05,MAX_VELOCITY:.05},Ge=({reference:o,storage:n,InputManager:e})=>{let t,r={direction:new Vector3(0,0,-1),velocity:new Vector3(0,0,0),rotationApplied:{pitch:0,yaw:0}},a={inputDirection:new Vector3(0,0,0)},i={player:null},l=()=>{try{let p=n.getStorage("model").retrieve(o.storageId);if(!p)throw new Error(`player doesn't exist for the id ${o.storageId}`);let E=p?.groups,b=p?.animations,h=new AnimationMixer(E),v=He({mixer:h,actions:{Idle:h.clipAction(b[0]),Walk:h.clipAction(b[3]),Run:h.clipAction(b[1])},crossFadeDuration:.3}),g=Ke({animationController:v,inputs:e});g.mount(),i={player:E},t={input:{mouse:e.getController("mouse"),keyboard:e.getController("keyboard")},animation:v,fsm:g};}catch(p){console.error(`Player mesh cant be obtained :${p}`);}},s=p=>{!p||!i.player||(r.rotationApplied=p.getRotation(),i.player.rotation.y+=r.rotationApplied.yaw);},u=(p,E)=>{if(!p||!i.player)return;let h=.001,{inputDirection:v}=a;if(v.set(0,0,0),p.isKeyPressed("w")&&(v.z-=1),p.isKeyPressed("s")&&(v.z+=1),p.isKeyPressed("a")&&(v.x-=1),p.isKeyPressed("d")&&(v.x+=1),v.length()>0)v.applyQuaternion(i.player.quaternion),v.normalize(),r.velocity.add(v.multiplyScalar(Ne.MOVEMENT_ACCELERATION*E)),r.velocity.clampLength(0,Ne.MAX_VELOCITY);else if(v.length()==0&&r.velocity.length()>0){let g=Math.exp(-5*E);r.velocity.multiplyScalar(g),r.velocity.lengthSq()<h*h&&r.velocity.set(0,0,0);}i.player.position.add(r.velocity);},d=p=>{s(t.input.mouse),u(t.input.keyboard,p);};return {mount:l,activate:()=>{},deactivate:()=>{},update:p=>(d(p),t.fsm.update(p),{position:i.player?.position??new Vector3(0,0,0),rotation:i.player?.rotation??new Euler(0,0,0,"XYZ"),rotationDelta:r.rotationApplied}),unmount:()=>{}}};var je=({player:o,ground:n})=>{let e=y(),[t,r,a,i,l]=[e.get("Logger"),e.get("GlobalStorageManager"),e.get("EventBusManager"),e.get("InputManager"),e.get("ThreeJSContextManager")],s={camera:Ae({camera:l.get("camera")}),player:Ge({reference:o,InputManager:i,storage:r}),ground:_e({camera:l.get("camera"),logger:t,references:n,storage:r})},u=null,c=null,m=false;return {mount:()=>{m||!s||(t.onMount({origin:"Navigation Room"}),u={player:{position:new Vector3(0,0,0),rotation:new Euler(0,0,0),rotationDelta:{yaw:0,pitch:0}}},c=r.getStorage("model").retrieve(n.storageId)??null,s.player.mount(),s.ground.mount(),s.camera.mount(),m=true);},update:h=>{!m||!s||!u||(l.get("orbit").update(),u.player=s.player.update(h),s.camera.update({playerPosition:u.player.position,rotationDelta:u.player.rotationDelta}));},unmount:()=>{!m||!s||(t.onUnmount({origin:"Navigation Room"}),s.player.unmount(),s.ground.unmount(),s=null,c=null);},setActive:()=>{!c||!s||(c.groups.visible=true,l.get("orbit").enabled=false,s.camera.activate(),s.ground.activate(),s.player.activate());},setDeactive:()=>{!c||!s||(c.groups.visible=false,s.camera.deactivate(),s.ground.deactivate(),s.player.deactivate());},isLoaded:false}};var Ue=({camera:o,eventBusManager:n,orbit:e,scene:t})=>{let r=[new Vector3(0,2,10),new Vector3(0,2,5),new Vector3(0,2,3),new Vector3(0,2,2),new Vector3(0,2,1),new Vector3(0,2,0),new Vector3(0,2,-1),new Vector3(0,1,-1),new Vector3(0,1,-1.5),new Vector3(0,1,-2)],a=new CatmullRomCurve3(r),i=0,l=false;return {mount:()=>{i=0;},activate:()=>{e.enabled=false,o.position.set(0,2.5,10),o.near=.001,o.far=1e3;},update:f=>{if(!l&&i>1&&(l=true,e.enabled=true,n.viewBus.emit({type:"project-screen:show",elementId:"project-screen"}),console.log("event emitted view event")),!l&&(i+=f*.1,i<=.9)){let S=a.getPointAt(i),p=a.getPointAt(i+.1);p.z-=.1,o.position.copy(S),o.lookAt(p);}},deactivate:()=>{},unmount:()=>{}}};var Fe=({reference:o,logger:n,storage:e})=>{let t=null;return {mount:()=>{let s=e.getStorage("model").retrieve(o.storageId)?.groups;if(t=s?.getObjectByName(o.id),!t){console.error(`Cant get ground mesh from the id : ${o.id}`);return}t.material=t.material.clone(),t.receiveShadow=true,t.material.needsUpdate=true,t.material.opacity=1,t.material.transparent=true;let u=["sky","ground"];s?.traverse(d=>{u.includes(d.name)||(d.castShadow=true);}),n.onMount({origin:"about-ground"});},actiavte:()=>{},deactivate:()=>{},unmount:()=>{}}};var Ve=({renderer:o,scene:n})=>{let e,t;return {mount:()=>{e=new DirectionalLight(16777215,5),e.castShadow=true,e.position.set(0,1,.5),e.target.position.set(0,0,0),e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.1,e.shadow.camera.far=50,e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10,t=new AmbientLight(16777215),o.shadowMap.enabled=true,o.shadowMap.type=PCFShadowMap;},activate:()=>{e&&n.add(e),t&&n.add(t);},deactivate:()=>{e&&n.remove(e),t&&n.remove(t);},unmount:()=>{}}};var qe=({logger:o,reference:n,storage:e})=>{let t,r=[],a=c=>{c.traverse(m=>{m.castShadow=true;});};return {mount:()=>{try{let c=e.getStorage("model").retrieve(n.storageId)?.groups,m=e.getStorage("model").retrieve(n.storageId)?.animations??[];if(!c)throw new Error(`player doesn't exist for the id ${n.storageId}`);t={playerRoot:c};let f=new AnimationMixer(c);f.clipAction(m[2]).play(),r.push(f),o.onMount({origin:"Project-Room-Player"});}catch(c){console.error(`Player mesh cant be obtained :${c}`);}},activate:()=>{t.playerRoot&&(t.playerRoot.rotation.set(0,0,0,"XYZ"),t.playerRoot.castShadow=true,a(t.playerRoot));},update:c=>{r.forEach(m=>{m.update(c);});},deactiavte:()=>{},unmount:()=>{}}};var $e=({player:o,ground:n})=>{let e=y(),[t,r,a,i]=[e.get("GlobalStorageManager"),e.get("ThreeJSContextManager"),e.get("EventBusManager"),e.get("Logger")],{scene:l,camera:s,orbit:u,renderer:d}={scene:r.get("scene"),camera:r.get("camera"),orbit:r.get("orbit"),renderer:r.get("renderer")},c={camera:Ue({camera:s,eventBusManager:a,orbit:u,scene:l}),player:qe({logger:i,reference:o,storage:t}),ground:Fe({logger:i,reference:n,storage:t}),lighting:Ve({renderer:d,scene:l})},m=null;return {mount:()=>{c.ground.mount(),c.player.mount(),c.camera.mount(),c.lighting.mount(),m=t.getStorage("model").retrieve(n.storageId)?.groups??null,i.onMount({origin:"Projects"});},setActive:()=>{m&&(m.visible=true),c.camera.activate(),c.lighting.activate(),c.player.activate();},update:h=>{c.player.update(h),c.camera.update(h);},setDeactive:()=>{m&&(m.visible=false),c.lighting.deactivate();},unmount:()=>{},isLoaded:false}};var Je=()=>{let o=y(),[n,e,t,r,a]=[o.get("GlobalStorageManager"),o.get("Logger"),o.get("EventBusManager"),o.get("ThreeJSContextManager"),o.get("GlobalStateManager")],i=null,l={navigation:null,about:null,projects:null},s={navigation:he,about:ve,projects:fe},u=null,d=null,c=()=>{try{i=we({storageManager:n,stateManager:a,loaderEventBus:t.loadingBus,renderer:r.get("renderer"),scene:r.get("scene")}),i?.configure();}catch(g){throw new Error(`[Gameplay] Couldnt create and initailize the loader due to ${g}`)}},m=g=>{switch(g){case "navigation":return l[g]=je(be),l[g];case "about":return l[g]=Pe(ye),l[g];case "projects":return l[g]=$e(Me),l[g];default:throw new Error(`Unknown Room key ${g}`)}},f=async g=>{if(!i)return;if(!s[g])throw new Error("[Room Controller] sufficient asset meta data is not given.");if(!l[g]){let B=m(g);console.log("load room",s[g]);let $=[...s[g].meshes];s[g].hdr&&$.push(s[g].hdr),await i.load($),B&&(B.mount(),B.isLoaded=true,u=B);}},S=async g=>{d!==g&&(d!=null&&l[d]!=null&&l[d].setDeactive(),await f(g),l[g]&&l[g].setActive(),d=g);},p=async()=>{e.onMount({origin:"Room Controller"}),c(),await i?.load([ge]),await f("navigation"),await S("navigation");},E=g=>{u?.update(g);},b=()=>{i?.dispose(),Object.values(l).forEach(g=>{g?.unmount();}),e.onUnmount({origin:"room-controller"});},h=g=>{t.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),Promise.allSettled([S(g)]).then(()=>{t.loadingBus.emit({type:"load:complete"});});},v=()=>{d&&u?.setDeactive();};return {mount:p,switchRoom:{navigation:()=>h("navigation"),about:()=>h("about"),projects:()=>h("projects"),default:()=>v()},update:E,unmount:b}};var ze=()=>{let o=y(),[n,e,t]=[o.get("EventBusManager"),o.get("Logger"),o.get("InputManager")],r=new Clock,a={deltaTime:0},i={deltaTime:0},l=false,s=Je(),u=()=>{n.displayBus.on("about:show",s.switchRoom.about),n.displayBus.on("about:hide",s.switchRoom.default),n.displayBus.on("projects:show",s.switchRoom.projects),n.displayBus.on("projects:hide",s.switchRoom.default),n.displayBus.on("home:show",s.switchRoom.navigation),n.displayBus.on("home:hide",s.switchRoom.default);},d=async()=>{l||(await s.mount(),u(),l=true,window.addEventListener("keyup",p=>{console.log(p);}));},c=()=>{i.deltaTime=r.getDelta(),!isNaN(i.deltaTime)&&i.deltaTime!==void 0&&(a.deltaTime=i.deltaTime);},m=()=>{c(),s.update(a.deltaTime??0);};return {onMount:d,update:m,onUnmount:()=>{}}};var We=o=>{let{fov:n,aspectRatio:e,near:t,far:r}=X,a=new Scene,i=new PerspectiveCamera(n,e,t,r),l=new WebGLRenderer({antialias:true}),s,u=null,d=null,c=y().get("ThreeJSContextManager"),m=y().get("Logger"),f=v=>{let g=document.getElementById(v);l.setSize(window.innerWidth,window.innerHeight),l.setPixelRatio(window.devicePixelRatio),g?(g.appendChild(l.domElement),s=new OrbitControls(i,l.domElement)):console.warn(`Could not find element with selector tag : ${v}`);},S=()=>{c.set("scene",a),c.set("camera",i),c.set("orbit",s),c.set("renderer",l);};return {onLoad:()=>[M(f,o.domMountId),M(S),M(m.onLoad,{origin:"ThreeJs-Manager"})],onMount:v=>[()=>{u=v;},M(m.onMount,{origin:"ThreeJs-Manager"})],onUpdate:()=>{if(d!==null)return;let v=()=>{d=requestAnimationFrame(v),u?.(),l.render(a,i);};v();},onUnmount:()=>{let v=document.getElementById(o.domMountId);d!==null&&(cancelAnimationFrame(d),d=0),v&&l.domElement.parentElement===v&&v.removeChild(l.domElement),l.dispose(),m.onUnmount({origin:"ThreeJs-Manager"});},onDestroy:()=>{}}};var Xe=(o,n)=>{let{height:e,width:t}={height:window.innerHeight,width:window.innerWidth};o.aspect=t/e,o.updateProjectionMatrix(),n.setSize(t,e);},qt=(o,n,e)=>{o.key.toLowerCase()==="u"&&o.shiftKey&&(o.preventDefault(),n.emit({type:"debug:inspector",scene:e}));},Ye=()=>{let o=y(),n=o.get("Logger"),e=We({domMountId:Y}),t,r=ze(),a,i,l=()=>{Xe(t.get("camera"),t.get("renderer")),window.addEventListener("resize",a),window.addEventListener("keydown",i);},s=()=>{window.removeEventListener("resize",a),window.removeEventListener("keydown",i);};return {onInit:()=>{},onLoad:()=>[...D(e.onLoad()),M(n.onLoad,{origin:"Render-Manager"})],onMount:()=>[()=>{t=o.get("ThreeJSContextManager"),a=E=>Xe(t.get("camera"),t.get("renderer")),i=E=>qt(E,o.get("EventBusManager").debugBus,t.get("scene"));},M(l),M(n.onMount,{origin:"Render-Manager"})],onUpdate:()=>[M(async()=>{try{await r.onMount();}catch{throw new Error("[Game Manager] Loading failed :${error}")}}),...D(e.onMount(()=>{})),M(e.onMount,r.update),M(e.onUpdate),M(n.onUpdate,0,{origin:"Render-Manager"})],onUnmount:()=>[M(s),M(r.onUnmount),M(e.onUnmount),M(n.onUnmount,{origin:"Render-Manager"})],onDestroy:()=>{n.onDestroy({origin:"RenderManager"});}}};var Ze=()=>{let o=y(),[n,e,t,r]=[o.get("Logger"),o.get("LifecycleScheduler"),o.get("GlobalStorageManager"),o.get("InputManager")],a,i,l=()=>{console.log("Engine initialized"),a=pe(),i=Ye(),e.schedule(t.inflate),e.schedule(r.onInit),e.schedule(a.onInit),e.schedule(i.onInit);},s=()=>{e.schedule(a.onLoad),e.schedule(i.onLoad),e.schedule(M(n.onLoad,{origin:"Engine"}));},u=()=>{n.onMount({origin:"Engine"}),e.schedule(a.onMount),e.schedule(i.onMount);},d=()=>{a.onUpdate(),e.schedule(i.onUpdate);},c=()=>{n.onUnmount({origin:"Engine"}),e.schedule(a.onUnmount),e.schedule(i.onUnmount),e.schedule(r.onUnmount);};return {run:()=>{l(),document.addEventListener("DOMContentLoaded",()=>{s();}),window.addEventListener("load",()=>{u(),d();}),window.addEventListener("beforeunload",()=>{c();}),e.run();}}};var Qe=()=>{let o=[];return {schedule:(...t)=>{t.forEach(r=>{o.push(r);});},run:()=>{let t=async()=>{let r=performance.now();for(;o.length>0&&performance.now()-r<20;){let a=o.shift();if(!a)continue;let i=a();if(i instanceof Promise){let l=await i;Array.isArray(l)&&o.unshift(...l);}else Array.isArray(i)&&o.unshift(...i);}requestAnimationFrame(()=>{t();});};t();}}};var C=()=>{let o=new Map,n=(i,l)=>{o.has(i)||o.set(i,new Set),o.get(i).add(l);},e=(i,l)=>{o.get(i)?.delete(l);};return Object.freeze({on:n,off:e,emit:i=>{o.get(i.type)?.forEach(l=>{l(i);});},clear:()=>{o.clear();},once:(i,l)=>{let s=u=>{l(u),e(i,s);};n(i,s);}})};var et=()=>{let o=C(),n=C(),e=C(),t=C(),r=C();return {loadingBus:o,displayBus:n,debugBus:e,switchTabBus:t,viewBus:r}};var tt=o=>{let n=o.initial,e=new Set;return Object.freeze({getValue:()=>n,setValue:s=>{n!==s&&(n=s,setTimeout(()=>{e.forEach(u=>u(s));},0));},subscribeToChanges:s=>(e.add(s),()=>{e.delete(s);}),dispose:()=>{e.clear();}})};var ot=o=>{let n={};return Object.freeze({inflate:()=>{for(let s in o){let u=tt({initial:o[s]});n[s]=u;}},getState:()=>{let s={};for(let u in n)s[u]=n[u].getValue();return s},setState:s=>{for(let u in s)n[u]&&n[u].setValue(s[u]);},getObservable:s=>n[s],subscribe:(s,u)=>n[s].subscribeToChanges(u),dispose:()=>{for(let s in n)n[s].dispose();}})};var nt=()=>({loading:ot({})});var rt=()=>{let o=y();o.register("LifecycleScheduler",Qe()),o.register("Logger",J()),o.register("EventBusManager",et()),o.register("GlobalStateManager",nt()),o.register("GlobalStorageManager",oe()),o.register("ThreeJSContextManager",z()),o.register("InputManager",ee()),Ze().run();};rt();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map