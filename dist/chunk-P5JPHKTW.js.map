{"version":3,"sources":["../src/engine/managers/animation/PlaybackManager.ts"],"names":["PlaybackManager","animationUnit","deltaTime","graph","params","fsm","activeClips","clip","animationName","blendDuration","speed","direction","mixer"],"mappings":"AAeO,IAAMA,CAAAA,CAAN,KAAiD,CAGtD,WAAA,CAAYC,CAAAA,CAAiC,CAC3C,IAAA,CAAK,aAAA,CAAgBA,EACvB,CAGA,IAAA,CACEC,CAAAA,CACAC,CAAAA,CACAC,CAAAA,CACAC,CAAAA,CACA,CAEAF,CAAAA,CAAM,IAAA,CAAKE,CAAAA,CAAKD,CAAM,CAAA,CAGtB,IAAME,CAAAA,CAAcH,CAAAA,CAAM,oBAAA,EAAqB,CAC/C,GAAIG,CAAAA,CAAY,MAAA,CAAS,CAAA,CAAG,CAC1B,IAAMC,CAAAA,CAAOD,CAAAA,CAAY,CAAC,CAAA,CAAE,IAAA,CAC5B,IAAA,CAAK,aAAA,CAAc,IAAA,CAAKC,CAAAA,CAAK,IAAW,EAC1C,CAGA,IAAA,CAAK,aAAA,CAAc,MAAA,CAAOL,CAAS,EACrC,CAGA,IAAA,CAAKM,CAAAA,CAAkBC,CAAAA,CAAwB,CAC7C,IAAA,CAAK,aAAA,CAAc,IAAA,CAAKD,CAAAA,CAAeC,CAAa,EACtD,CAGA,IAAA,EAAO,CACL,IAAA,CAAK,aAAA,CAAc,IAAA,GACrB,CAGA,mBAAA,EAAqC,CACnC,OAAO,IAAA,CAAK,aAAA,CAAc,mBAAA,EAC5B,CAGA,QAAA,CAASC,CAAAA,CAAe,CACtB,IAAA,CAAK,aAAA,CAAc,QAAA,CAASA,CAAK,EACnC,CAGA,YAAA,CAAaC,CAAAA,CAAmB,CAC9B,IAAA,CAAK,aAAA,CAAc,YAAA,CAAaA,CAAS,EAC3C,CAGA,OAAA,CAAQC,CAAAA,CAAwB,CAC9B,IAAA,CAAK,aAAA,CAAc,OAAA,CAAQA,CAAK,EAClC,CAGA,SAAA,EAAY,CACV,IAAA,CAAK,aAAA,CAAc,SAAA,GACrB,CAGA,oBAAA,EAA2C,CACzC,OAAO,CACL,CACE,IAAA,CAAM,IAAA,CAAK,mBAAA,EAAoB,CAC/B,MAAA,CAAQ,CACV,CACF,CACF,CACF","file":"chunk-P5JPHKTW.js","sourcesContent":["import { AnimationMixer } from \"three\";\nimport { AnimationUnit } from \"./AnimationUnit\";\nimport { AnimationFSM } from \"./FSM\";\nimport { AnimationGraphRuntime } from \"./GraphRuntime\";\nimport { AnimationParameters } from \"./Parameters\";\n\n/** Represents a single playing animation (optional, can expose state) */\nexport interface PlayingAnimation {\n  name: string | null;\n  weight: number;\n}\n\n/**\n * PlaybackManager: wraps a Three.js AnimationUnit\n */\nexport class PlaybackManager<T extends string = string> {\n  private animationUnit: AnimationUnit<T>;\n\n  constructor(animationUnit: AnimationUnit<T>) {\n    this.animationUnit = animationUnit;\n  }\n\n  /** Tick/update the animation unit */\n  tick(\n    deltaTime: number,\n    graph: AnimationGraphRuntime,\n    params: AnimationParameters,\n    fsm: AnimationFSM\n  ) {\n    // 1. Update graph with FSM state\n    graph.tick(fsm, params);\n\n    // 2. Get active clip\n    const activeClips = graph.getCurrentAnimations();\n    if (activeClips.length > 0) {\n      const clip = activeClips[0].clip;\n      this.animationUnit.play(clip.name as any);\n    }\n\n    // 3. Advance the mixer\n    this.animationUnit.update(deltaTime);\n  }\n\n  /** Play a specific animation by name */\n  play(animationName: T, blendDuration?: number) {\n    this.animationUnit.play(animationName, blendDuration);\n  }\n\n  /** Stop current animation */\n  stop() {\n    this.animationUnit.stop();\n  }\n\n  /** Get current animation name */\n  getCurrentAnimation(): string | null {\n    return this.animationUnit.getCurrentAnimation();\n  }\n\n  /** Set playback speed */\n  setSpeed(speed: number) {\n    this.animationUnit.setSpeed(speed);\n  }\n\n  /** Set playback direction */\n  setDirection(direction: 1 | -1) {\n    this.animationUnit.setDirection(direction);\n  }\n\n  /** Mount the AnimationUnit with a Three.js mixer */\n  onMount(mixer?: AnimationMixer) {\n    this.animationUnit.onMount(mixer);\n  }\n\n  /** Cleanup */\n  onUnmount() {\n    this.animationUnit.onUnmount();\n  }\n\n  /** Expose simplified \"playing animation\" for orchestrator */\n  getPlayingAnimations(): PlayingAnimation[] {\n    return [\n      {\n        name: this.getCurrentAnimation(),\n        weight: 1, // optional, can extend with blending info\n      },\n    ];\n  }\n}\n"]}