{"version":3,"sources":["../src/gameplay/rooms/about/room.ts"],"names":["createAboutRoom","ground","player","serviceRegistry","getServiceRegistry","storage","logger","context","scene","camera","orbit","renderer","components","createCameraManager","createPlayer","createGround","createLighting","group","deltaTime"],"mappings":"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","file":"chunk-MFFY27Z4.js","sourcesContent":["import { Group, Object3DEventMap } from \"three\";\n\nimport { getServiceRegistry } from \"engine/core/ServiceRegistry\";\nimport { ModelIdentifier, Room } from \"types/rooms.types\";\nimport { CameraManager, createCameraManager } from \"./camera\";\nimport { createGround, Ground } from \"./ground\";\nimport { createLighting, Lighting } from \"./lights\";\nimport { createPlayer, Player } from \"./player\";\n\nexport interface AboutRoomProps {\n  player: ModelIdentifier;\n  ground: ModelIdentifier;\n}\n\ninterface Components {\n  camera: CameraManager;\n  player: Player;\n  ground: Ground;\n  lighting: Lighting;\n}\n\nexport const createAboutRoom = ({ ground, player }: AboutRoomProps): Room => {\n  //====References====\n  const serviceRegistry = getServiceRegistry();\n  const [storage, logger, context] = [\n    serviceRegistry.get(\"GlobalStorageManager\"),\n    serviceRegistry.get(\"Logger\"),\n    serviceRegistry.get(\"ThreeJSContextManager\"),\n  ];\n\n  const { scene, camera, orbit, renderer } = {\n    scene: context.get(\"scene\")!,\n    camera: context.get(\"camera\")!,\n    orbit: context.get(\"orbit\")!,\n    renderer: context.get(\"renderer\")!,\n  };\n\n  //===Local===\n  const components: Components = {\n    camera: createCameraManager({ camera: camera, scene: scene }),\n    player: createPlayer({ logger, reference: player, scene, storage }),\n    ground: createGround({ logger, reference: ground, storage }),\n    lighting: createLighting({ renderer, scene }),\n  };\n\n  let group: Nullable<Group<Object3DEventMap>> = null;\n\n  const mount = () => {\n    logger.onMount({ origin: \"About-Room\" });\n    components.ground.mount();\n    components.player.mount();\n    components.camera.mount();\n    components.lighting.mount();\n    group =\n      storage.getStorage(\"model\").retrieve(ground.storageId)?.groups ?? null;\n  };\n\n  const activate = () => {\n    if (group) group.visible = true;\n\n    orbit.enabled = false;\n    components.camera.activate();\n    components.ground.actiavte();\n    components.lighting.activate();\n    components.player.activate();\n    logger.onActivate({ origin: \"About-Room\" });\n  };\n\n  const update = (deltaTime: number) => {\n    //components.camera.update(deltaTime);\n  };\n\n  const deactivate = () => {\n    if (group) group.visible = false;\n\n    components.camera.deactivate();\n    components.ground.deactivate();\n    components.lighting.deactivate();\n    components.player.deactiavte();\n    logger.onDeactivate({ origin: \"About-Room\" });\n  };\n\n  const unmount = () => {\n    components.camera.unmount();\n    components.ground.unmount();\n    components.lighting.unmount();\n    components.player.unmount();\n    logger.onUnmount({ origin: \"About-Room\" });\n  };\n\n  return {\n    mount: mount,\n    setActive: activate,\n    update: update,\n    setDeactive: deactivate,\n    unmount: unmount,\n    isLoaded: false,\n  };\n};\n"]}