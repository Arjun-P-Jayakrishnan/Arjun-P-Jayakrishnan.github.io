import {a as a$3}from'./chunk-Z6DMPIJV.js';import {a as a$5}from'./chunk-7RWTZPGD.js';import {a as a$4}from'./chunk-R6CHGND3.js';import {a}from'./chunk-P6US56ME.js';import {a as a$2}from'./chunk-X7UR4SJO.js';import {a as a$1,d,c,b}from'./chunk-LBLZSNCB.js';import {c as c$1,b as b$1,a as a$6}from'./chunk-V5XTZ25L.js';var $=()=>{let r=a(),[_,u,n,c$2,N]=[r.get("GlobalStorageManager"),r.get("Logger"),r.get("EventBusManager"),r.get("ThreeJSContextManager"),r.get("GlobalStateManager")],e=null,t={navigation:null,about:null,projects:null},i={navigation:b,about:c,projects:d},l=null,a$7=null,P=()=>{try{e=a$2({storageManager:_,stateManager:N,loaderEventBus:n.loadingBus,renderer:c$2.get("renderer"),scene:c$2.get("scene")}),e?.configure();}catch(o){throw new Error(`[Gameplay] Couldnt create and initailize the loader due to ${o}`)}},y=o=>{switch(o){case "navigation":return t[o]=a$5(a$6),t[o];case "about":return t[o]=a$4(b$1),t[o];case "projects":return t[o]=a$3(c$1),t[o];default:throw new Error(`Unknown Room key ${o}`)}},d$1=async o=>{if(!e)return;if(!i[o])throw new Error("[Room Controller] sufficient asset meta data is not given.");if(!t[o]){let s=y(o);console.log("load room",i[o]);let g=[...i[o].meshes];i[o].hdr&&g.push(i[o].hdr),await e.load(g),s&&(s.mount(),s.isLoaded=true,l=s);}},R=async o=>{a$7!==o&&(n.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),a$7!=null&&t[a$7]!=null&&t[a$7].setDeactive(),await d$1(o),t[o]&&t[o].setActive(),a$7=o,n.loadingBus.emit({type:"load:complete"}));},B=async()=>{u.onMount({origin:"Room Controller"}),P(),await e?.load([a$1]),await d$1("navigation"),await R("navigation");},K=o=>{l?.update(o);},C=()=>{e?.dispose(),Object.values(t).forEach(o=>{o?.unmount();}),u.onUnmount({origin:"room-controller"});},m=o=>{n.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),Promise.allSettled([R(o)]).then(()=>{n.loadingBus.emit({type:"load:complete"});});},j=()=>{a$7&&l?.setDeactive();};return {mount:B,switchRoom:{navigation:()=>m("navigation"),about:()=>m("about"),projects:()=>m("projects"),default:()=>j()},update:K,unmount:C}};export{$ as a};//# sourceMappingURL=chunk-IEYGABJH.js.map
//# sourceMappingURL=chunk-IEYGABJH.js.map