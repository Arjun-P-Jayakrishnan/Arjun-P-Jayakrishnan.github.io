import {a as a$3}from'./chunk-AXBI24QS.js';import {a as a$4}from'./chunk-MFFY27Z4.js';import {a as a$5}from'./chunk-VMECZDOQ.js';import {a as a$1}from'./chunk-SWJKXIQY.js';import {a}from'./chunk-P6US56ME.js';import {a as a$2,d,c,b}from'./chunk-LBLZSNCB.js';import {c as c$1,b as b$1,a as a$6}from'./chunk-V5XTZ25L.js';var F=()=>{let e=a(),[u,c$2,n,d$1,N,g,y]=[e.get("GlobalStorageManager"),e.get("Logger"),e.get("EventBusManager"),e.get("ThreeJSContextManager"),e.get("GlobalStateManager"),e.get("AnimationManager"),e.get("InputManager")],a$7=null,t={navigation:null,about:null,projects:null},i={navigation:b,about:c,projects:d},s=null,r=null,B=()=>{try{a$7=a$1({storageManager:u,stateManager:N,loaderEventBus:n.loadingBus,renderer:d$1.get("renderer"),scene:d$1.get("scene")}),a$7?.configure();}catch(o){throw new Error(`[Gameplay] Couldnt create and initailize the loader due to ${o}`)}},K=o=>{switch(o){case "navigation":return t[o]=a$5(a$6),t[o];case "about":return t[o]=a$4(b$1),t[o];case "projects":return t[o]=a$3(c$1),t[o];default:throw new Error(`Unknown Room key ${o}`)}},R=async o=>{if(!a$7)return;if(!i[o])throw new Error("[Room Controller] sufficient asset meta data is not given.");if(!t[o]){let l=K(o);console.log("load room",i[o]);let v=[...i[o].meshes];i[o].hdr&&v.push(i[o].hdr),await a$7.load(v),l&&(l.mount(),l.isLoaded=true,s=l);}},p=async o=>{r!==o&&(n.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),r!=null&&t[r]!=null&&t[r].setDeactive(),await R(o),t[o]&&t[o].setActive(),r=o,s=t[o],n.loadingBus.emit({type:"load:complete"}));},C=async()=>{await a$7?.load([a$2]),g.mount("Player",u,y);},I=async()=>{c$2.onMount({origin:"Room Controller"}),B(),await C(),await R("navigation"),await p("navigation");},j=o=>{s?.update(o),g.update(o);},L=()=>{a$7?.dispose(),Object.values(t).forEach(o=>{o?.unmount();}),c$2.onUnmount({origin:"room-controller"});},m=o=>{n.loadingBus.emit({type:"load:start",loaded:0,total:0,url:""}),Promise.allSettled([p(o)]).then(()=>{n.loadingBus.emit({type:"load:complete"});});},G=()=>{r&&s?.setDeactive();};return {mount:I,switchRoom:{navigation:()=>m("navigation"),about:()=>m("about"),projects:()=>m("projects"),default:()=>G()},update:j,unmount:L}};export{F as a};//# sourceMappingURL=chunk-NONPNT2M.js.map
//# sourceMappingURL=chunk-NONPNT2M.js.map