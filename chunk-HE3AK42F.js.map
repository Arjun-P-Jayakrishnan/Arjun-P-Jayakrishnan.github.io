{"version":3,"sources":["../src/graphics/internal/internal.ts"],"sourcesContent":["import { AxesHelper, PerspectiveCamera, Scene, WebGLRenderer } from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\n\nexport interface ThreeJSRenderProps {\n  /**\n   * Properties for camera\n   */\n  camera: {\n    fov?: number;\n    aspect?: number;\n    near?: number;\n    far?: number;\n  };\n  /**\n   * Tag to which renderer has to be attached\n   */\n  domMountTag: string;\n}\n\nexport interface ThreeJsRenderReference {\n  scene: Scene;\n  camera: PerspectiveCamera;\n  renderer: WebGLRenderer;\n  controls: OrbitControls;\n\n  /**\n   * @description Mount\n   */\n  mount: () => void;\n  /**\n   * @description\n   * @param loop the callback for updating\n   */\n  register: (loop: () => void) => void;\n  /**\n   * @description Loop\n   */\n  render: () => void;\n  /**\n   * @description UnMount\n   */\n  dispose: (disposeCallbacks: Array<() => void>) => void;\n}\n\n/**\n * @description Creates a threejs environment in which further additions can be made\n * @param props properties that define the setup of game engine\n * @returns Render Lifecycle methods\n */\nexport const createThreeJsInstance = (\n  props: ThreeJSRenderProps\n): ThreeJsRenderReference => {\n  //Local references\n\n  let scene: Scene = new Scene();\n\n  let camera: PerspectiveCamera = new PerspectiveCamera(\n    props.camera.fov,\n    props.camera.aspect,\n    props.camera.near,\n    props.camera.far\n  );\n\n  let renderer: WebGLRenderer = new WebGLRenderer({ antialias: true });\n\n  let controls: OrbitControls = new OrbitControls(camera, renderer.domElement);\n\n  let animationLoop: () => void | undefined;\n\n  /**\n   * @description add the renderer so that it can display the 3d\n   * @param tag the dom tag to which the renderer is to be attached\n   */\n  const _mountRenderer = (tag: string) => {\n    const container = document.getElementById(tag);\n\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    if (container) {\n      container.appendChild(renderer.domElement);\n    } else {\n      console.warn(`Could not find element with selector tag : ${tag}`);\n    }\n  };\n\n  /**\n   * @description setup initial properties of orbital controls\n   */\n  const _configureControls = () => {\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.25;\n    controls.screenSpacePanning = false;\n    controls.maxPolarAngle = Math.PI / 2;\n  };\n\n  const addAxesHelper = () => {\n    const axes_helper = new AxesHelper();\n    scene.add(axes_helper);\n  };\n\n  const mount = () => {\n    _mountRenderer(props.domMountTag);\n    _configureControls();\n\n    camera.position.set(0, 0, 0.5);\n    scene.add(camera);\n\n    addAxesHelper();\n  };\n\n  const register = (loop: () => void) => {\n    animationLoop = loop;\n  };\n\n  /**\n   * @description Life cycle method similar to update\n   */\n  const render = () => {\n    //Recursive callback function\n    requestAnimationFrame(render);\n\n    controls.update();\n\n    if (animationLoop) {\n      animationLoop();\n    }\n\n    //Render scene from cameras perspective\n    renderer.render(scene, camera);\n  };\n\n  /**\n   * @description Life cycle method similar to UnMount\n   * @param disposeCallbacks array of dispose callbacks to be executed\n   */\n  const dispose = (disposeCallbacks: Array<() => void>) => {\n    disposeCallbacks.forEach((fn) => fn());\n\n    renderer.dispose();\n    controls.dispose();\n  };\n\n  return Object.freeze({\n    scene: scene,\n    camera: camera,\n    controls: controls,\n    renderer: renderer,\n\n    mount: mount,\n    register: register,\n    render: render,\n    dispose: dispose,\n  });\n};\n"],"mappings":";AAAA,SAAS,YAAY,mBAAmB,OAAO,qBAAqB;AACpE,SAAS,qBAAqB;AAgDvB,IAAM,wBAAwB,CACnC,UAC2B;AAG3B,MAAI,QAAe,IAAI,MAAM;AAE7B,MAAI,SAA4B,IAAI;AAAA,IAClC,MAAM,OAAO;AAAA,IACb,MAAM,OAAO;AAAA,IACb,MAAM,OAAO;AAAA,IACb,MAAM,OAAO;AAAA,EACf;AAEA,MAAI,WAA0B,IAAI,cAAc,EAAE,WAAW,KAAK,CAAC;AAEnE,MAAI,WAA0B,IAAI,cAAc,QAAQ,SAAS,UAAU;AAE3E,MAAI;AAMJ,QAAM,iBAAiB,CAAC,QAAgB;AACtC,UAAM,YAAY,SAAS,eAAe,GAAG;AAE7C,aAAS,QAAQ,OAAO,YAAY,OAAO,WAAW;AACtD,aAAS,cAAc,OAAO,gBAAgB;AAE9C,QAAI,WAAW;AACb,gBAAU,YAAY,SAAS,UAAU;AAAA,IAC3C,OAAO;AACL,cAAQ,KAAK,8CAA8C,GAAG,EAAE;AAAA,IAClE;AAAA,EACF;AAKA,QAAM,qBAAqB,MAAM;AAC/B,aAAS,gBAAgB;AACzB,aAAS,gBAAgB;AACzB,aAAS,qBAAqB;AAC9B,aAAS,gBAAgB,KAAK,KAAK;AAAA,EACrC;AAEA,QAAM,gBAAgB,MAAM;AAC1B,UAAM,cAAc,IAAI,WAAW;AACnC,UAAM,IAAI,WAAW;AAAA,EACvB;AAEA,QAAM,QAAQ,MAAM;AAClB,mBAAe,MAAM,WAAW;AAChC,uBAAmB;AAEnB,WAAO,SAAS,IAAI,GAAG,GAAG,GAAG;AAC7B,UAAM,IAAI,MAAM;AAEhB,kBAAc;AAAA,EAChB;AAEA,QAAM,WAAW,CAAC,SAAqB;AACrC,oBAAgB;AAAA,EAClB;AAKA,QAAM,SAAS,MAAM;AAEnB,0BAAsB,MAAM;AAE5B,aAAS,OAAO;AAEhB,QAAI,eAAe;AACjB,oBAAc;AAAA,IAChB;AAGA,aAAS,OAAO,OAAO,MAAM;AAAA,EAC/B;AAMA,QAAM,UAAU,CAAC,qBAAwC;AACvD,qBAAiB,QAAQ,CAAC,OAAO,GAAG,CAAC;AAErC,aAAS,QAAQ;AACjB,aAAS,QAAQ;AAAA,EACnB;AAEA,SAAO,OAAO,OAAO;AAAA,IACnB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IAEA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AACH;","names":[]}